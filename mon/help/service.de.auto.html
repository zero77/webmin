<header> MON-Hilfe zu Service-Definitionen </header><p> Dies ist die zweite und letzte Stufe für die MON-Konfiguration. <p> Standardwerte werden für die obligatorischen Dienste angezeigt <marked in RED color> . Weitere Hilfe zu den Service-Definitionen finden Sie im jeweiligen Hilfethema unten. <p> <b>Stellen Sie</b> für <b>&quot;mail.alert&quot;</b> sicher, dass sendmail konfiguriert ist und <b>&quot;sendmail&quot;</b> -Deamon auf der Hostmaschine gestartet ist. <H3> Service-Definitionen </H3><P><DL COMPACT><DT> <B>Service</b> <I>Servicename</i> <DD> Eine Dienstdefinition beginnt mit dem Schlüsselwort <B>service,</b> gefolgt von einem Wort, das das Tag für diesen Dienst ist. <P> Die Komponenten eines Dienstes sind ein Intervall, ein Monitor und eine oder mehrere Zeitperiodendefinitionen, wie unten definiert. <P> Wenn in einer Überwachungsgruppe mit dem Namen &quot;dafault&quot; (siehe oben) der Dienstname &quot;default&quot; definiert ist, wird die Standard- / Standarddefinition für die Behandlung unbekannter Mon-Traps verwendet. <P><DT> <B>Intervall</b> <I>Zeitwert</i> <DD> Das Schlüsselwort <B>Intervall</b> , gefolgt von einem Zeitwert gibt die Häufigkeit , dass ein Monitor Skript ausgelöst. Zeitwerte sind definiert als &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot; oder &quot;1d&quot;, was 30 Sekunden, 5 Minuten, 1 Stunde oder 1 Tag bedeutet. Der numerische Teil kann ein Bruchteil sein, wie beispielsweise &quot;1,5 h&quot; oder anderthalb Stunden. Dieses Format einer Zeitangabe wird als <I>Zeitwert bezeichnet</i> . <P><DT> <B>Traptimeout-</b> <I>Zeitwert</i> <DD> Dieses Schlüsselwort nimmt das gleiche Zeitangabe Argument als <B><I>Intervall,</i></b> und macht den Service erwartet eine Falle von einer externen Quelle zumindest die häufig, sonst ein Fehler registriert wird. Dies wird für einen Service im Heartbeat-Stil verwendet. <P><DT> <B>Trapduration</b> <I>Zeitwert</i> <DD> Wenn eine Falle empfangen wird, bleibt der Status des Dienstes, an den die Falle geliefert wurde, normalerweise konstant. Wenn die <B>Trapduration</b> angegeben ist, bleibt der Status des Dienstes für die durch <I>timeval</i> angegebene Dauer in einem <I>Fehlerzustand</i> und wird dann auf &quot;Erfolg&quot; zurückgesetzt. <P><DT> <B>randskew</b> <I>timeval</i> <DD> Anstatt das Monitor-Skript so zu planen, dass es zu Beginn jedes Intervalls ausgeführt wird, passen Sie das durch den <B>Intervallparameter</b> angegebene Intervall nach dem Zufallsprinzip mit einem Plus- oder Minus- <B>Rand an.</b> Der Versatzwert wird als <B>Intervallparameter</b> angegeben: &quot;30s&quot;, &quot;5m&quot; usw. Wenn beispielsweise das <B>Intervall</b> 1m und der <B>Randkeww</b> &quot;5s&quot; beträgt, <B>plant</b> <I>mon</i> das Monitorskript einige Zeit zwischen 55 Sekunden und 65 Sekunden. Ziel ist es, die Last auf dem Server zu verteilen, wenn viele Dienste in denselben Intervallen geplant sind. <P><DT> <B>Monitor</b> <I>Monitorname [arg ...]</i> <DD> Der Schlüsselwort - <B>Monitor</b> , gefolgt von einem Skriptnamen und Argumenten gibt an dem Monitor zu laufen , wenn der Timer abläuft. Shell-ähnliche Anführungskonventionen werden befolgt, wenn die Argumente angegeben werden, die an das Monitorskript gesendet werden sollen. Das Skript wird aus dem mit dem Argument <B>-s</b> angegebenen Verzeichnis aufgerufen, und alle folgenden Wörter werden als Argumente an das Überwachungsprogramm übergeben, gefolgt von der Liste der Hosts in der Gruppe, auf die die aktuelle Überwachungsgruppe verweist. Wenn die Monitorzeile mit &quot;;;&quot; endet Als separates Wort werden die Hostgruppen beim Aufrufen des Programms nicht an die Argumentliste angehängt. <P><DT> <B>allow_empty_group</b> <DD> Mit der Option <B>allow_empty_group</b> kann ein Monitor aufgerufen werden, auch wenn die Hostgruppe für diese Überwachung aufgrund deaktivierter Hosts leer ist. Das Standardverhalten besteht darin, den Monitor nicht aufzurufen, wenn alle Hosts in einer Hostgruppe deaktiviert wurden. <P><DT> <B>Beschreibung</b> <I>Beschreibungstext</i> <DD> Der Text nach der <B>Beschreibung</b> wird von Client-Programmen abgefragt und über eine Umgebungsvariable an Warnungen und Monitore übergeben. Es sollte eine kurze Beschreibung des Dienstes enthalten, die zur Aufnahme in eine E-Mail oder auf einer Webseite geeignet ist. <P><DT> <B>exclude_hosts</b> <I>host [host ...]</i> <DD> Alle Hosts, die nach <B>exclude_hosts aufgeführt</b> sind, werden von der Serviceprüfung ausgeschlossen. <P><DT> <B>exclude_period</b> <I>periodspec</i> <DD> Führen Sie während der durch <I>periodspec angegebenen</i> Zeit keinen geplanten Monitor aus. <P><DT> <B>abhängig von der</b> <I>Abhängigkeit</i> <DD> Die <B>depend</b> Schlüsselwort verwendet wird , eine Abhängigkeit Ausdruck angeben, welche auswertet , um entweder wahr von falsch, im boolean Sinne. Abhängigkeiten sind tatsächliche Perl-Ausdrücke und müssen allen syntaktischen Regeln entsprechen. Die Ausdrücke werden in ihrem eigenen Paketbereich ausgewertet, um nicht versehentlich unerwünschte Nebenwirkungen zu haben. Wenn bei der Auswertung des Ausdrucks ein Syntaxfehler festgestellt wird, wird dieser über syslog protokolliert. <P> Vor der Auswertung werden die folgenden Ersetzungen für den Ausdruck vorgenommen: Ausdrücke, die wie &quot;Gruppe: Dienst&quot; aussehen, werden durch den Wert des aktuellen Betriebsstatus des angegebenen Dienstes ersetzt. Diese Opstatus-Ersetzungen werden rekursiv berechnet. Wenn also Service A von Service B und Service B von Service C abhängt, hängt Service A von Service C ab. Erfolgreiche Betriebszustände (die mit &quot;1&quot; bewertet werden) sind &quot;STAT_OK&quot;, &quot;STAT_COLDSTART&quot; &quot;,&quot; STAT_WARMSTART &quot;und&quot; STAT_UNKNOWN &quot;. Das Wort &quot;SELBST&quot; (in Großbuchstaben) kann für die Gruppe verwendet werden (z. B. &quot;SELBST: Dienst&quot;) und ist eine Abkürzung für die aktuelle Überwachungsgruppe. <P> Diese Funktion kann verwendet werden, um Warnungen für Dienste zu steuern, die von anderen Diensten abhängig sind, z. B. einen SMTP-Test, der davon abhängt, ob der Computer per Ping erreichbar ist. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> Die Auswertung von Abhängigkeitsgraphen kann die Unterdrückung von Alarm- oder Überwachungsaufrufen steuern. <P> <B>Alarmunterdrückung</b> . Wenn diese Option auf &quot;a&quot; gesetzt ist, wird der Abhängigkeitsausdruck ausgewertet, nachdem der Monitor für den Dienst beendet wurde oder nachdem ein Trap empfangen wurde. Eine Warnung wird nur gesendet, wenn die Auswertung erfolgreich ist. Dies bedeutet, dass keiner der Knoten im Abhängigkeitsdiagramm einen Fehler anzeigt. <P> <B>Unterdrückung unterdrücken</b> . Wenn es auf &quot;m&quot; gesetzt ist, wird der Abhängigkeitsausdruck ausgewertet, bevor der Monitor für den Dienst ausgeführt wird. Wenn die Auswertung erfolgreich ist, wird der Monitor ausgeführt. Andernfalls wird der Monitor nicht ausgeführt und der Status des Dienstes bleibt unverändert. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Periodendefinitionen </H3><P> Zeiträume werden verwendet, um die Bedingungen zu definieren, unter denen Warnungen zugestellt werden sollen. <P><DL COMPACT><DT> <B>period</b> <I>[label:] periodspec</i> <DD> In einem Zeitraum werden ein oder mehrere Alarme und Variablen zusammengefasst, die steuern, wie oft ein Alarm bei einem Fehler auftritt. Das Schlüsselwort <B>period</b> hat zwei Formen. Das erste Argument basiert auf einer Periodenspezifikation aus Patrick Ryans Modul Time :: Period Perl 5. Weitere Informationen finden Sie unter &quot;perldoc Time :: Period&quot;. <P> Das zweite Formular erfordert ein Etikett, gefolgt von einer Periodenspezifikation, wie oben definiert. Das Label ist ein Tag, das aus einem alphabetischen Zeichen oder Unterstrich besteht, gefolgt von null oder mehr alphanumerischen Zeichen oder Unterstrichen und mit einem Doppelpunkt endet. Dieses Formular ermöglicht mehrere Perioden mit derselben Periodendefinition. Eine Verwendung besteht darin, eine Periodendefinition zu haben, die für einen bestimmten Zeitraum keine <B>Alertafter-</b> oder <B>Alertevery-</b> Parameter enthält, und eine andere für denselben Zeitraum mit einem anderen Satz von Alerts, der diese Parameter enthält. <P><DT> <B>immer</b> <I>zeitlich</i> <DD> Das Schlüsselwort <B>alertevery</b> (innerhalb einer <B>Periodendefinition</b> ) verwendet denselben Argumenttyp wie die <B>Intervallvariable</b> und begrenzt die <B>Häufigkeit</b> , mit der eine Warnung gesendet wird, wenn der Dienst weiterhin fehlschlägt. Wenn das Intervall beispielsweise &quot;1h&quot; ist, werden nur die Warnungen im Periodenabschnitt nur einmal pro Stunde ausgelöst. Wenn das Schlüsselwort <B>alertevery</b> in einem Periodeneintrag weggelassen wird, wird jedes Mal eine Warnung gesendet, wenn ein Fehler erkannt wird. Wenn sich die Ausgabe von zwei aufeinander folgenden Fehlern ändert, wird standardmäßig das Alarmintervall überschrieben. Wenn das Wort &quot;Zusammenfassung&quot; das letzte Argument ist, werden beim Vergleich der Ausgabe aufeinanderfolgender Fehler nur die Zusammenfassungsausgabezeilen berücksichtigt. <P><DT> <B>alertafter</b> <I>num</i> <DD><P><DT> <B>alertafter</b> <I>num timeval</i> <DD> Das <B>alertafter</b> Schlüsselwort (innerhalb eines <B>Zeitraums</b> Abschnitt) hat zwei Formen: nur mit der „num“ -Argument, oder mit den „num timeval“ Argumenten. In der ersten Form wird eine Warnung nur nach &quot;num&quot; aufeinanderfolgenden Fehlern aufgerufen. <P> In der zweiten Form sind die Argumente eine positive ganze Zahl gefolgt von einem Intervall, wie oben durch das <B>Intervallvariable</b> beschrieben. Wenn diese Parameter angegeben werden, werden die Warnungen für diesen Zeitraum erst aufgerufen, nachdem innerhalb dieses Intervalls viele Fehler aufgetreten sind. Wenn beispielsweise <B>alertafter</b> die Argumente &quot;3 30m&quot; erhält, wird die Warnung aufgerufen, wenn innerhalb von 30 Minuten 3 Fehler auftreten. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Diese Variable weist den Server an, während eines Fehlers nicht mehr als <I>num-</i> Warnungen aufzurufen. Der Alarmzähler wird pro Periode gehalten und bei jedem Erfolg zurückgesetzt. <P><DT> <B>comp_alerts</b> <DD><P> Wenn diese Option angegeben ist, werden Upalerts nur aufgerufen, wenn ein entsprechender &quot;Down&quot; -Alarm aufgerufen wurde. <P><DT> <B>alert</b> <I>alert [arg ...]</i> <DD> Ein Zeitraum kann mehrere Warnungen enthalten, die bei einem Ausfall des Dienstes ausgelöst werden. Ein Alarm wird mit dem <B>Alert</b> - Schlüsselwort angegeben wird , durch einen optionalen <B>Ausgang</b> Parmeter gefolgt, und Argumente , die die gleiche wie die <B>Monitordefinition</b> interpretiert werden, aber ohne die „;;“ Ausnahme. Der <B>Exit-</b> Parameter hat die Form <B>exit = x</b> oder <B>exit = xy</b> und bewirkt, dass die Warnung nur aufgerufen wird, wenn der Exit-Status des Monitorskripts in den Bereich des <B>Exit-</b> Parameters fällt. Wenn die <I>Alarmzeile</i> beispielsweise <I>alert exit = 10-20 mail.alert mis lautet,</i> wird <I>mail-alert</i> nur mit <I>mis</i> als Argument aufgerufen, wenn der Exit-Wert des Überwachungsprogramms zwischen 10 und 20 liegt. Mit dieser Funktion können Sie auslösen Unterschiedliche Warnungen mit unterschiedlichen Schweregraden (z. B. wenn der freie Speicherplatz von 8% auf 3% steigt). <P> <B>Im</b> Abschnitt <B>ALERTPROGRAMME</b> oben finden Sie eine Liste der Parameter, die mon automatisch an Alarmprogramme weiterleitet. <P><DT> <B>upalert</b> <I>alert [arg ...]</i> <DD> Ein <B>Upalert</b> ist das Kompliment eines <B>Alarms</b> . Ein Upalert wird aufgerufen, wenn ein Dienst den Statusübergang von Fehler zu Erfolg durchführt. Das <B>Upalert-</b> Skript wird aufgerufen und liefert dieselben Parameter wie das <B>Alert-</b> Skript. Hinzu kommt der Parameter <B>-u</b> , mit dem ein Alert-Skript einfach darüber informiert wird, dass es als Upalert aufgerufen wird. Für jede Periodendefinition können mehrere Upalerts angegeben werden. Bitte beachten Sie, dass das Standardverhalten darin besteht, dass ein Upalert gesendet wird, unabhängig davon, ob zuvor &quot;Down&quot; -Warnungen gesendet wurden, da Upalerts bei einem Statusübergang ausgelöst werden. <B>Stellen Sie die</b> Option comp_alerts pro Periode <B>ein,</b> um Upalerts mit &quot;Down&quot; <B>-Warnungen</b> zu koppeln. <P><DT> <B>Startalarm</b> <I>Alarm [arg ...]</i> <DD> Ein <B>Startalarm</b> wird nur aufgerufen, wenn der <B>Mon-</b> Server die Ausführung startet. <P><DT> <B>upalertafter</b> <I>timeval</i> <DD> Der Parameter <B>upalertafter</b> wird als Zeichenfolge angegeben, die der Syntax des <B>Intervallparameters</b> (&quot;30s&quot;, &quot;1m&quot; usw.) folgt und das Auslösen eines <B>upalert steuert</b> . Wenn ein Dienst nach einer <B>Ausfallzeit</b> , die größer oder gleich dem Wert dieser Option ist, wieder <B>hochgefahren</b> wird, wird ein <B>Upalert</b> aufgerufen. Verwenden Sie diese Option, um zu verhindern, dass Upalerts aufgrund von &quot;Blips&quot; (kurzen Ausfällen) aufgerufen werden. <P>