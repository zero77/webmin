<header> MON Súgó a szolgáltatásmeghatározásokhoz </header><p> Ez a MON konfiguráció második és utolsó lépése. <p> Az alapértelmezett értékek a kötelező szolgáltatásoknál jelennek meg <marked in RED color> . A szolgáltatásmeghatározásokkal kapcsolatos további segítségért lásd az alábbi megfelelő súgótémakört. <p> A <b>&quot;mail.alert&quot;</b> esetén ellenőrizze, hogy a sendmail konfigurálva van-e és a <b>&quot;sendmail&quot;</b> deamon elindul-e a hostgépen. <H3> Szolgáltatásmeghatározások </H3><P><DL COMPACT><DT> <B>szolgáltatási</b> <I>szervnév</i> <DD> A szolgáltatás meghatározása azzal kezdődik, hogy a <B>szolgáltatás</b> kulcsszót követi egy szóval, amely a szolgáltatás címkéje. <P> A szolgáltatás összetevői egy intervallum, monitor és egy vagy több időtartam-meghatározás, az alábbiak szerint. <P> Ha az &quot;alapértelmezett&quot; szolgáltatásnevet egy &quot;alapértelmezett&quot; néven figyelő csoporton belül definiálják (lásd fent), akkor az alapértelmezett / alapértelmezett meghatározást az ismeretlen mondagda kezelésére használják. <P><DT> <B>intervallum</b> <I>timeval</i> <DD> A kulcsszó- <B>intervallum</b> , amelyet egy időérték követ, meghatározza a monitor szkriptjének indítási gyakoriságát. Az időértékeket &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot; vagy &quot;1d&quot; -ként definiáljuk, ami 30 másodperc, 5 perc, 1 óra vagy 1 nap jelentése. A numerikus rész lehet tört, például &quot;1,5h&quot; vagy másfél óra. Az idő specifikációjának ezt a formátumát <I>időértéknek nevezzük</i> . <P><DT> <B>traptimeout</b> <I>timeval</i> <DD> Ez a kulcsszó ugyanazt az időmeghatározási érvet veszi igénybe, mint az <B>intervallum</b> <I>,</i> és arra készteti a szolgáltatót, hogy legalább egy külső forrásból csapdát várjon el, különben hiba kerül regisztrálásra. Ezt szívveréses stílusú szolgáltatásként használják. <P><DT> <B>trapduration</b> <I>időintervallum</i> <DD> Csapda érkezése esetén a csapda által nyújtott szolgáltatás állapota általában változatlan marad. Ha a <B>csapdázást</b> meghatározzák, akkor a szolgáltatás állapota meghibásodott állapotban marad az <I>időintervallumban</i> megadott <I>ideig</i> , majd &quot;sikere&quot; -re állítja vissza. <P><DT> <B>randskew</b> <I>timeval</i> <DD> Ahelyett, hogy a monitor szkriptet az egyes intervallumok kezdetén <B>futtatná</b> , véletlenszerűen állítsa be az intervallumparaméter által megadott <B>intervallumot</b> plusz vagy mínusz <B>randskew értékkel.</b> A ferde értéket <B>intervallumparaméterként</b> <B>adják meg</b> : &quot;30s&quot;, &quot;5m&quot;, stb. Például, ha az <B>intervallum</b> 1m, és a <B>randskew</b> &quot;5s&quot;, akkor a <I>mon</i> az 55 másodperc és minden egyes másodperc között ütemezi a monitor szkriptet. 65 másodperc. A cél az, hogy elősegítse a szerver terhelésének elosztását, ha sok szolgáltatás ütemezése azonos időközönként. <P><DT> <B>monitor</b> <I>monitor neve [arg ...]</i> <DD> A <B>monitor</b> kulcsszó, amelyet a szkript neve és az argumentumok követ, meghatározza, hogy a monitort mikor kell futtatni, amikor az időzítő lejár. A héjszerű idéző konvenciókat be kell tartani, amikor meghatározzák a monitor parancsfájlhoz küldendő argumentumokat. A szkriptet a <B>-s</b> argumentummal megadott könyvtárból hívják meg, és az összes következő szót argumentumként továbbítják a monitor programhoz, amelyet a csoport gazdagépeinek listája követ, amelyet az aktuális figyelőcsoport utal. Ha a monitor sora &quot;;;&quot; külön szóként a gazdacsoportokat nem csatolják az argumentumlistához, amikor a programot meghívják. <P><DT> <B>allow_empty_group</b> <DD> Az <B>allow_empty_group</b> opció lehetővé teszi a monitor meghívását akkor is, ha az adott óra gazdacsoportja üres a letiltott gazdagépek miatt. Az alapértelmezett viselkedés nem hívja meg a monitort, ha a gazdacsoport összes gazdagépe le van tiltva. <P><DT> <B>leírás</b> <I>leíró szöveg</i> <DD> A szöveg következő <B>leírás</b> lekérdezhetőek kliens programok, át riasztások és monitorok keresztül egy környezeti változó. Tartalmaznia kell a szolgáltatás rövid leírását, amely alkalmas e-mailben vagy egy weboldalon történő felvételre. <P><DT> <B>exit_hosts</b> <I>host [host ...]</i> <DD> A kizárt <B>szellemek</b> után felsorolt gazdagépeket kizárjuk a szolgáltatás-ellenőrzésből. <P><DT> <B>exclude_period</b> <I>periodspec</i> <DD> Ne üzemeltessen egy ütemezett monitort az <I>periodpec</i> által meghatározott idő alatt. <P><DT> <B>függ a</b> <I>dependexpressziótól</i> <DD> A <B>függõ</b> kulcsszót egy függõségi kifejezés meghatározására használják, amely logikai értelemben igaz vagy hamis értékre értékeli. A függőségek a Perl tényleges kifejezései, és be kell tartaniuk az összes szintaktikai szabályt. A kifejezéseket a saját csomagterületükben értékelik, hogy véletlenül ne legyenek nem kívánt mellékhatásaik. Ha szintaxis hibát talál a kifejezés kiértékelésekor, akkor a naplóba kerül. <P> Az értékelés előtt a kifejezés következő helyettesítései történnek: a „csoport: szolgáltatás” -hoz hasonló kifejezések helyébe az adott szolgáltatás aktuális működési állapotának értéke lép. Ezeket az opstatus-helyettesítéseket rekurzív módon számítják ki, tehát ha az A szolgáltatás függ a B szolgáltatástól, és a B szolgáltatás függ a C szolgáltatástól, akkor az A szolgáltatás függ a C szolgáltatástól. A sikeres működési állapotok (amelyek &quot;1&quot; -re értékelik) &quot;STAT_OK&quot;, &quot;STAT_COLDSTART&quot;. &quot;,&quot; STAT_WARMSTART &quot;és&quot; STAT_UNKNOWN &quot;. A &quot;SELF&quot; szó (minden sapkában) használható a csoportra (pl. &quot;SELF: service&quot;), és az az aktuális figyelőcsoport rövidítése. <P> Ez a szolgáltatás felhasználható az egyéb szolgáltatásoktól függő szolgáltatások riasztásainak vezérlésére, például egy SMTP tesztre, amely attól függ, hogy a gép ping-elérhető-e. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> A függőségi gráfok kiértékelése szabályozhatja a riasztások vagy a monitorhívások elnyomását. <P> <B>Riasztás elnyomása</b> . Ha ezt az opciót &quot;a&quot; -ra állítják, akkor a függőségi kifejezést akkor értékelik, amikor a szolgáltatás monitorja kilép, vagy miután csapdát kapott. Riasztás csak akkor kerül elküldésre, ha az értékelés sikeres, vagyis a függőségi gráf egyik csomópontja sem jelez hibát. <P> <B>Monitor elnyomás</b> . Ha &quot;m&quot; -re állítja, akkor a függőségi kifejezés elpárologni kezd, mielőtt a szolgáltatási monitor futni kezd. Ha az elpárologtatás sikeres, akkor a monitort futtatják. Ellenkező esetben a monitor nem fog működni, és a szolgáltatás állapota változatlan marad. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Időszak meghatározások </H3><P> A periódusokat azoknak a feltételeknek a meghatározására használják, amelyeknek lehetővé kell tenniük a riasztások kézbesítését. <P><DL COMPACT><DT> <B>időszak</b> <I>[címke:] periodpecpec</i> <DD> Az időszak egy vagy több riasztást és változót csoportosít, amelyek szabályozzák, hogy a riasztás milyen gyakran forduljon elő hiba esetén. Az <B>időszak</b> kulcsszójának két formája van. Az első olyan érvet vesz, amely egy Patrick Ryan Idő :: Period Perl 5 modul periódus-specifikációja. További információkért lásd &quot;perldoc idő :: Időszak&quot;. <P> A második űrlaphoz címkét igényel, amelyet egy időszak meghatározása követ, a fentiek szerint. A címke egy olyan ábécé karakterből vagy aláhúzásból álló címke, amelyet nulla vagy annál több alfanumerikus vagy aláhúzás követ, és kettőspont zárul le. Ez a forma több periódust tesz lehetővé ugyanazon időszak meghatározásával. Az egyik használat egy olyan <B>időszakdefiníció,</b> amelynek nincs <B>riasztási</b> paramétere vagy <B>riasztási</b> paramétere egy adott időtartamra, és egy másik alkalmazás ugyanazon időtartamra, egy másik riasztási készlettel, amely tartalmazza ezeket a paramétereket. <P><DT> <B>riasztási</b> <I>időintervallum</i> <DD> A <B>alertevery</b> kulcsszó <B>(belül</b> felbontású) veszi az azonos típusú érvelés, mint az <B>intervallum</b> változó, és korlátozza a száma, ahányszor egy riasztást küld, ha a szolgáltatás továbbra is sikertelen. Például, ha az intervallum &quot;1h&quot;, akkor csak az időszak szakaszban található riasztások csak óránként egyszer aktiválódnak. Ha a <B>figyelmeztetés-</b> kulcsszót kihagyják egy időszak bejegyzéséből, akkor a riasztást minden alkalommal ki kell adni, amikor egy hibát észlelnek. Alapértelmezés szerint, ha két egymást követő hiba kimenete megváltozik, akkor a figyelmeztetési intervallum felülbírálásra kerül. Ha az &quot;összefoglaló&quot; szó az utolsó érv, akkor csak az összefoglaló kimeneti sorokat veszi figyelembe az egymást követő hibák kimenetének összehasonlításakor. <P><DT> <B>alertafter</b> <I>szám</i> <DD><P><DT> <B>alertafter</b> <I>num timeval</i> <DD> Az <B>alertafter</b> kulcsszó (egy <B>szakasz</b> szakaszon belül) két formája van: csak a &quot;num&quot; argumentummal vagy a &quot;num timeval&quot; argumentumokkal. Az első formában a riasztást csak &quot;szám&quot; egymást követő hibák után hívják meg. <P> A második formában az argumentumok pozitív egész szám, amelyet egy intervallum követ, amelyet a fenti <B>intervallumváltozó</b> ír le. Ha ezeket a paramétereket meghatározzák, akkor az arra az időszakra vonatkozó riasztásokat csak akkor hívják meg, ha sok hiba történik ezen az időtartamon belül. Például, ha az <B>alertafter-</b> nek megkapja a &quot;3 30m&quot; argumentumot, akkor a riasztás <B>hívásra</b> kerül, ha 3 hiba történik 30 percen belül. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Ez a változó azt mondja a szervernek, hogy hiba esetén legfeljebb <I>szám</i> riasztásokat hívjon fel. A riasztási számlálót időszakonként tartják, és minden siker esetén visszaállítják. <P><DT> <B>comp_alerts</b> <DD><P> Ha ez az opció megadva, akkor az upalerts csak akkor hívja meg, ha a megfelelő &quot;le&quot; riasztást hívták. <P><DT> <B>riasztási</b> <I>riasztás [arg ...]</i> <DD> Egy időszak több riasztást tartalmazhat, amelyeket a szolgáltatás meghibásodása vált ki. A riasztást a <B>riasztási</b> kulcsszó határozza meg, amelyet egy opcionális <B>kilépési</b> paraméter követ, és az argumentumok ugyanúgy értelmezésre kerülnek, mint a <B>monitordefiníció</b> , de a &quot;;;&quot; nélkül. kivétel. Az <B>exit</b> paraméter <B>exit = x</b> vagy <B>exit = xy formában jelenik meg,</b> és a riasztást csak akkor hívják meg, ha a monitor szkriptének kilépési állapota az <B>exit</b> paraméter tartományába esik. Ha például a figyelmeztető vonal <I>éber exit = 10-20 mail.alert mis</i> majd <I>mail-riasztás</i> csak akkor lehet hivatkozni a <I>mis</i> mint argumentumot, ha a monitor program kilépési értéke 10 és 20 között Ez a funkció lehetővé teszi, hogy ravaszt különböző riasztások különböző súlyossági szinteken (például amikor a szabad lemezterület 8% -ról 3% -ra nő). <P> Lásd a fenti <B>RIASZTÁSI PROGRAMOK</b> szakaszt, ahol a gyakorlók listája automatikusan továbbadódik a riasztási programokhoz. <P><DT> <B>upalert</b> <I>figyelmeztetés [arg ...]</i> <DD> Az <B>upalert</b> a <B>riasztás</b> <B>bókja</b> . Upalert akkor hívódik meg, amikor egy szolgáltatás az államot átalakítja a kudarcról a sikerre. Az <B>upalert</b> szkriptet ugyanazokkal a paraméterekkel <B>látják el,</b> mint a <B>riasztási</b> szkriptet, kiegészítve a <B>-u</b> paraméterrel, amelyet egyszerűen arra használnak, hogy riasztási szkript tudja, hogy upalertnak hívják. Több upalert adható meg az egyes időszakdefiníciókhoz. Felhívjuk figyelmét, hogy az alapértelmezett viselkedés az, hogy egy upalert küldésre kerül, függetlenül attól, hogy volt-e korábbi &quot;lefelé&quot; figyelmeztetést, mivel az upalert egy állapotátmeneten vált ki. Állítsa be az időszakonkénti <B>comp_alerts</b> beállítást az upalerts &quot;páros&quot; riasztásokkal való párosításához. <P><DT> <B>startupalert</b> <I>figyelmeztetés [arg ...]</i> <DD> A <B>startupalert</b> csak akkor hívódik meg, amikor a <B>mon</b> szerver végrehajtást indít. <P><DT> <B>upalerta</b> <I>After Timeval</i> <DD> Az <B>upalertafter</b> paraméter olyan <B>stringként</b> van megadva, amely követi az <B>intervallumparaméter</b> szintaxisát (&quot;30s&quot;, &quot;1m&quot; stb.), És vezérli az <B>upalert indítását</b> . Ha egy szolgáltatás visszatér, miután leállt egy ideje, vagy annál nagyobb, mint az opció értéke, akkor <B>upalert hívásra</b> kerül. Ezzel a beállítással megakadályozhatja az upalert hívását &quot;blips&quot; (rövid kiesések) miatt. <P>