<header> Nápověda k definici služby MON </header><p> Toto je druhá a poslední fáze konfigurace MON. <p> Pro služby Povinné jsou zobrazeny výchozí hodnoty <marked in RED color> . Další nápovědu k definicím služeb naleznete v níže uvedeném tématu nápovědy. <p> U <b>&quot;mail.alert&quot;</b> se ujistěte, že je nakonfigurován <b>sendmail</b> a na hostmachine je spuštěn deamon <b>&quot;sendmail&quot;</b> . <H3> Definice služeb </H3><P><DL COMPACT><DT> <B>servisní</b> <I>název</i> <B>služby</b> <DD> Definice služby začíná tím, že <B>služba</b> klíčových slov následuje slovo, které je značkou této služby. <P> Součásti služby jsou interval, monitor a jedna nebo více definic časového období, jak je definováno níže. <P> Pokud je název služby „default“ definován ve skupině sledovaných volaných „dafault“ (viz výše), použije se výchozí / výchozí definice pro zpracování neznámých mon trapů. <P><DT> <B>intervalové</b> <I>časování</i> <DD> <B>Interval</b> klíčových slov následovaný časovou hodnotou určuje frekvenci spouštění monitorovacího skriptu. Časové hodnoty jsou definovány jako „30s“, „5m“, „1h“ nebo „1d“, což znamená 30 sekund, 5 minut, 1 hodinu nebo 1 den. Číselná část může být zlomek, například „1,5 hodiny“ nebo hodinu a půl. Tento formát časové specifikace bude označován jako <I>časově závislý</i> . <P><DT> <B>Traptimeout</b> <I>timeval</i> <DD> Toto klíčové slovo má stejný specifikace argumentu úvazek jako <B><I>interval,</i></b> a dělá službu očekávají pasti z externího zdroje alespoň tak často, jinak selhání bude registrován. Používá se pro službu ve stylu srdce. <P><DT> <B>trapduration</b> <I>timeval</i> <DD> Je-li pasti přijata, zůstane stav služby, do které byla pasti doručena, obvykle konstantní. Je-li <B>zadána trapdurace</b> , zůstane stav služby ve stavu selhání po dobu stanovenou <I>timevalem</i> a poté bude resetována na „úspěch“. <P><DT> <B>randskew</b> <I>timeval</i> <DD> Spíše než naplánovat, aby se monitorovací skript spouštěl na začátku každého intervalu, náhodně upravte interval určený parametrem <B>intervalu</b> pomocí plus nebo mínus <B>randskew.</b> Hodnota zkosení je zadána jako parametr <B>intervalu</b> : &quot;30s&quot;, &quot;5m&quot; atd. Například, pokud je <B>interval</b> 1m a <B>randskew</b> je &quot;5s&quot;, pak <I>mon</i> naplánuje monitorovací skript někdy mezi každých 55 sekund a 65 sekund. Záměrem je pomoci distribuovat zatížení serveru, když je naplánováno mnoho služeb ve stejných intervalech. <P><DT> <B>Monitor</b> <I>Monitor-name [arg ...]</i> <DD> <B>Monitor</b> klíčovým slovem následuje jméno skriptu a argumenty Udává monitor spustit po vypršení časovače. Při určování argumentů, které mají být odeslány do skriptu monitoru, jsou dodržovány konvence citace ve skořápce. Skript je vyvolán z adresáře zadaného s argumentem <B>-s</b> a všechna následující slova jsou dodávána jako argumenty pro monitorovací program, za kterým následuje seznam hostitelů ve skupině, na kterou odkazuje aktuální sledovací skupina. Pokud řádek monitoru končí „;;“ jako samostatné slovo nejsou hostitelské skupiny při vyvolání programu připojeny k seznamu argumentů. <P><DT> <B>allow_empty_group</b> <DD> Možnost <B>allow_empty_group</b> umožní <B>spuštění</b> monitoru, i když je hostitelská skupina pro tyto hodinky prázdná z důvodu deaktivovaných hostitelů. Výchozí chování není vyvolání monitoru, když byli deaktivováni všichni hostitelé v hostitelské skupině. <P><DT> <B>description</b> <I>descriptiontext</i> <DD> Text Následující <B>popis</b> je dotazován klientské programy přešlo k záznamům a monitorů pomocí proměnné prostředí. Měl by obsahovat stručný popis služby, vhodný pro zahrnutí do e-mailu nebo na webovou stránku. <P><DT> <I>hostitel_hostitele</i> <B>výjimky</b> <I>[hostitel ...]</i> <DD> Jakékoli hostitelů uvedené po <B>exclude_hosts</b> bude ze servisní prohlídky vyloučena. <P><DT> <B>exclude_period</b> <I>periodspec</i> <DD> Neprovádějte plánovaný monitor v době <I>určené periodou</i> . <P><DT> <B>závislý</b> <I>výraz</i> <DD> <B>Depend</b> klíčové slovo se používá k určení výraz závislost, který je vyhodnocen jako pravdivý buď falešně, v booleovské smyslu. Závislosti jsou skutečné výrazy Perlu a musí dodržovat všechna syntaktická pravidla. Výrazy jsou vyhodnoceny ve vlastním prostoru balíčku, aby náhodně neměly nějaký nežádoucí vedlejší účinek. Pokud je při vyhodnocení výrazu nalezena syntaktická chyba, je zaznamenána pomocí syslogu. <P> Před vyhodnocením se ve výrazu vyskytují následující substituce: fráze, které vypadají jako „skupina: služba“, jsou nahrazeny hodnotou aktuálního provozního stavu dané určené služby. Tyto substituce opstatus se počítají rekurzivně, takže pokud služba A závisí na službě B a služba B závisí na službě C, pak služba A závisí na službě C. Úspěšné provozní stavy (které se vyhodnocují jako „1“) jsou „STAT_OK“, „STAT_COLDSTART &quot;,&quot; STAT_WARMSTART &quot;a&quot; STAT_UNKNOWN &quot;. Slovo „SELF“ (ve všech velkých písmenech) lze použít pro skupinu (např. „SELF: service“) a je zkratkou pro aktuální skupinu hodinek. <P> Tuto funkci lze použít k řízení výstrah pro služby, které jsou závislé na jiných službách, např. Test SMTP, který je závislý na tom, zda je stroj ping dosažitelný. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> Vyhodnocení grafů závislosti může řídit potlačení výstrah nebo sledování vyvolání. <P> <B>Potlačení výstrahy</b> . Pokud je tato možnost nastavena na „a“, bude výraz závislosti vyhodnocen po ukončení sledování služby nebo po přijetí pasti. Výstraha bude odeslána, pouze pokud vyhodnocení proběhne úspěšně, což znamená, že žádný z uzlů v grafu závislosti nenaznačuje selhání. <P> <B>Sledujte potlačení</b> . Pokud je nastavena na &quot;m&quot;, bude závislost výrazu evakuován před spuštěním monitoru služby. Pokud bude evakuace úspěšná, bude spuštěn monitor. V opačném případě nebude monitor spuštěn a stav služby zůstane stejný. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Definice období </H3><P> Období se používá k definování podmínek, které by měly umožnit doručení výstrah. <P><DL COMPACT><DT> <B>period</b> <I>[label:] periodspec</i> <DD> Období seskupuje jeden nebo více poplachů a proměnných, které řídí, jak často se výstraha stane, když dojde k poruše. Klíčové slovo <B>období</b> má dvě formy. První vezme argument, který je specifikací období z modulu Patrick Ryan Time :: Period Perl 5. Další informace naleznete v části „perldoc Time :: Period“. <P> Druhý formulář vyžaduje štítek následovaný specifikací období, jak je definováno výše. Štítek je značka skládající se z abecedního znaku nebo podtržítka následovaná nulou nebo více alfanumerickými znaky nebo podtržítka a končící dvojtečkou. Tento formulář umožňuje více období se stejnou definicí období. Jedno použití je mít definici dobu, která nemá žádný nebo <B>alertafter</b> <B>alertevery</b> parametry pro určité časové období, a druhý pro stejné časové období s jinou sadu záznamů, které se obsahují tyto parametry. <P><DT> <B>alertevery</b> <I>timeval</i> <DD> Klíčové slovo <B>alertevery</b> (v rámci definice <B>období</b> ) bere stejný typ argumentu jako proměnná <B>interval</b> a omezuje počet odesílání výstrah, když služba pokračuje v selhání. Pokud je například interval „1h“, pak se pouze upozornění v sekci období spustí pouze jednou za hodinu. Je-li klíčové slovo <B>alertevery</b> vynechán v položce období, bude výstraha být rozeslány pokaždé, když je detekována porucha. Ve výchozím nastavení, pokud se změní výstup dvou po sobě jdoucích selhání, je interval alertevery přepsán. Je-li slovo „shrnutí“ posledním argumentem, budou při porovnávání výstupu opakovaných selhání brány v úvahu pouze souhrnné výstupní řádky. <P><DT> <B>alertafter</b> <I>num</i> <DD><P><DT> <B>alertafter</b> <I>num timeval</i> <DD> <B>Klíčové</b> slovo <B>výstrahy po</b> (v sekci <B>období</b> ) má dvě formy: pouze s argumentem „num“ nebo s argumenty „num timeval“. V první podobě bude výstraha vyvolána až po „num“ po sobě jdoucích selháních. <P> Ve druhé podobě jsou argumenty kladné celé číslo následované intervalem, jak je popsáno výše uvedenou proměnnou <B>intervalu</b> . Pokud jsou tyto parametry zadány, budou upozornění na toto období vyvolána až poté, co v daném intervalu dojde k mnoha selháním. Například, pokud <B>výstraha</b> bude dána argumenty „3 30 m“, výstraha bude vyvolána, pokud dojde k <B>třem</b> selháním do 30 minut. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Tato proměnná říká serveru, aby během selhání <I>nevolával</i> více než <I>num</i> upozornění. Počitadlo výstrah je uchováváno na periodě a po každém úspěchu je resetováno. <P><DT> <B>comp_alerts</b> <DD><P> Je-li tato možnost zadána, vyvolá se upalerts pouze v případě, že bylo vyvoláno odpovídající upozornění na „down“. <P><DT> <B>výstražné</b> <I>upozornění [arg ...]</i> <DD> Období může obsahovat více upozornění, která se spouští při selhání služby. Výstraha je specifikována klíčovým slovem <B>výstrahy</b> , následovaným volitelným parametrem <B>exit</b> a argumenty, které jsou interpretovány stejně jako definice <B>monitoru</b> , ale bez znaku &quot;;;&quot; výjimka. Parametr <B>exit</b> má podobu <B>exit = x</b> nebo <B>exit = xy</b> a má za následek, že se výstraha vyvolá pouze v případě, že stav ukončení monitorovacího skriptu spadá do rozsahu parametru <B>exit</b> . Pokud je například výstražným řádkem <I>výstraha exit = 10-20 mail.alert mis,</i> pak bude <I>upozornění mail</i> vyvoláno s <I>mis</i> jako argumenty, pokud je výstupní hodnota monitorovacího programu mezi 10 a 20. Tato funkce umožňuje spustit různá upozornění na různých úrovních závažnosti (například když volné místo na disku klesne z 8% na 3%). <P> V části <B>ALERT PROGRAMY</b> výše najdete seznam pramaeters mon, který automaticky předá výstražné programy. <P><DT> <B>upalert</b> <I>alert [arg ...]</i> <DD> <B>Upalert</b> je <B>doplňkem</b> <B>výstrahy</b> . Upalert je volán, když služby způsobí přechod státu z neúspěchu do úspěchu. <B>Upalert</b> skript se nazývá dodávající stejné parametry jako <B>varovný</b> skript, s přidáním parametru <B>-u,</b> který se jednoduše používá, aby varovný skript věděl, že je volán jako upalert. Pro každou definici období lze zadat více upalertů. Vezměte prosím na vědomí, že výchozí chování je, že upalert bude odeslán bez ohledu na to, zda došlo k nějakým předchozím &quot;down&quot; upozorněním, protože upalert se spustí při přechodu na stav. Nastavte možnost <B>comp_alerts</b> za období <B>tak,</b> aby spárovala upalerts s upozorněními „down“. <P><DT> <I>výstraha při</i> <B>spuštění</b> <I>[arg ...]</i> <DD> <B>Startalert</b> je volán pouze v případě, že <B>mon</b> server spustí spuštění. <P><DT> <B>upalertafter</b> <I>timeval</i> <DD> Parametr <B>upalertafter</b> je určen jako řetězec, který sleduje syntaxi <B>intervalu</b> parametru (&quot;30s&quot;, &quot;1m&quot; atd.) A řídí spouštění <B>upalert</b> . Pokud se služba vrátí zpět po <B>výpadku</b> po dobu delší nebo rovnou hodnotě této možnosti, bude <B>vyvolán upalert</b> . Použijte tuto možnost, chcete-li zabránit vyvolání upozorňování kvůli „výkyvům“ (krátké výpadky). <P>