<header> Ajutor MON pentru definițiile serviciului </header><p> Aceasta este a doua și ultima etapă pentru configurarea MON. <p> Valorile implicite sunt afișate pentru serviciile obligatorii <marked in RED color> . Consultați subiectul de ajutor respectiv de mai jos pentru mai mult ajutor la definițiile serviciului. <p> Pentru <b>„mail.alert”</b> , asigurați-vă că sendmail-ul este configurat și deamon-ul <b>„sendmail”</b> este pornit pe hostmachine. <H3> Definițiile serviciului </H3><P><DL COMPACT><DT> <I>nume de</i> <B>serviciu</b> <DD> O definiție a serviciului începe cu <B>serviciul de</b> cuvinte cheie urmată de un cuvânt care este eticheta pentru acest serviciu. <P> Componentele unui serviciu sunt un interval, un monitor și una sau mai multe definiții ale perioadei de timp, așa cum sunt definite mai jos. <P> Dacă un nume de serviciu „implicit” este definit în cadrul unui grup de veghe numit „dafault” (a se vedea mai sus), atunci definiția implicită / implicită va fi utilizată pentru gestionarea capcanelor mon necunoscute. <P><DT> <B>interval</b> <I>timeval</i> <DD> <B>Intervalul de</b> cuvinte cheie urmat de o valoare de timp specifică frecvența cu care un script de monitor va fi declanșat. Valorile de timp sunt definite ca &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot; sau &quot;1d&quot;, adică 30 de secunde, 5 minute, 1 oră sau 1 zi. Porțiunea numerică poate fi o fracție, cum ar fi „1,5 ore” sau o oră și jumătate. Acest format al unei specificații de timp va fi denumit <I>timeval</i> . <P><DT> <B>timp de</b> <I>traptimeout</i> <DD> Acest cuvânt cheie are același timp specificații ca argument <B><I>interval,</i></b> și face serviciul se așteaptă la o capcană de la o sursă externă de cel puțin că de multe ori, altfel un eșec va fi înregistrată. Aceasta este folosită pentru un serviciu în stilul bătăilor inimii. <P><DT> <B>timp de</b> <I>capturare</i> <DD> Dacă se primește o capcană, starea serviciului în care a fost livrată capcana va rămâne, în mod normal, constantă. Dacă este specificată <B>capturarea</b> , starea serviciului va rămâne într-o stare de eșec pe durata specificată de intervalul de <I>timp</i> , apoi va fi resetată la „succes”. <P><DT> <B>randskew</b> <I>timeval</i> <DD> În loc să programați scriptul monitorului pentru a rula la începutul fiecărui interval, ajustați aleatoriu intervalul specificat de parametrul de <B>intervale</b> cu plus-sau-minus <B>randskew.</b> Valoarea skew este specificată ca parametru de <B>interval</b> : &quot;30s&quot;, &quot;5m&quot;, etc ... De exemplu, dacă <B>intervalul</b> este 1m, iar <B>randskew</b> este &quot;5s&quot;, atunci <I>Mon</i> va programa scriptul monitorului ceva timp între fiecare 55 de secunde și 65 de secunde. Intenția este de a ajuta distribuirea încărcăturii pe server atunci când multe servicii sunt programate la aceleași intervale. <P><DT> <B>monitor</b> <I>monitor-nume [arg ...]</i> <DD> <B>Monitorul de</b> cuvinte cheie urmat de un nume de script și argumente specifică monitorul care va fi rulat la expirarea cronometrului. Convențiile de cotație asemănătoare cochiliei sunt urmate atunci când se specifică argumentele care trebuie trimise scriptului monitorului. Scriptul este invocat din directorul dat cu argumentul <B>-s</b> și toate cuvintele următoare sunt furnizate ca argumente pentru programul de monitorizare, urmată de lista de gazde din grupul la care face referire grupul de vizionare curent. Dacă linia monitorului se termină cu &quot;;;&quot; ca un cuvânt separat, grupurile gazdă nu sunt anexate la lista de argumente atunci când este invocat programul. <P><DT> <B>allow_empty_group</b> <DD> Opțiunea <B>allow_empty_group</b> va permite invocarea unui monitor chiar și atunci când grupul gazdă pentru acel ceas este gol din cauza gazdelor dezactivate. Comportamentul implicit este acela de a nu invoca monitorul atunci când toate gazdele dintr-un grup de gazdă au fost dezactivate. <P><DT> <B>descriere</b> <I>descriere text</i> <DD> Textul care urmează <B>descrierea</b> este solicitat de programele client, transmise la alerte și monitoare printr-o variabilă de mediu. Acesta trebuie să conțină o scurtă descriere a serviciului, potrivită pentru includerea într-un e-mail sau pe o pagină web. <P><DT> <B>exclude_hosts</b> <I>gazdă [gazdă ...]</i> <DD> Orice gazdă listată după <B>exclude_hosts</b> va fi exclusă din verificarea serviciului. <P><DT> <B>exclude_period</b> <I>periodpec</i> <DD> Nu rulați un monitor programat în timpul identificat de <I>periodică</i> . <P><DT> <B>depind</b> <I>dependexpression</i> <DD> Cuvântul cheie <B>depend</b> este utilizat pentru a specifica o expresie de dependență, care se evaluează fie adevărată a falsă, în sensul boolean. Dependențele sunt expresii reale de Perl și trebuie să respecte toate regulile sintactice. Expresiile sunt evaluate în propriul spațiu al pachetului pentru a nu avea accidente un efect secundar nedorit. Dacă se găsește o eroare de sintaxă la evaluarea expresiei, aceasta este înregistrată prin syslog. <P> Înainte de evaluare, apar următoarele substituții ale expresiei: frazele care arată ca „grup: serviciu” sunt înlocuite cu valoarea stării operaționale curente a acelui serviciu specificat. Aceste substituții opstatus sunt calculate recursiv, deci dacă serviciul A depinde de serviciul B, iar serviciul B depinde de serviciul C, atunci serviciul A depinde de serviciul C. Statutele operaționale de succes (care se evaluează la &quot;1&quot;) sunt &quot;STAT_OK&quot;, &quot;STAT_COLDSTART &quot;,&quot; STAT_WARMSTART &quot;și&quot; STAT_UNKNOWN &quot;. Cuvântul „SELF” (în toate capacele) poate fi folosit pentru grup (de ex. „SELF: service”) și este o prescurtare pentru grupul de veghe curent. <P> Această caracteristică poate fi utilizată pentru a controla alertele pentru servicii care sunt dependente de alte servicii, de exemplu, un test SMTP care depinde de accesibilitatea ping-ului. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> Evaluarea graficelor de dependență poate controla suprimarea invocărilor de alertă sau de monitorizare. <P> <B>Suprimarea alertelor</b> . Dacă această opțiune este setată pe „a”, atunci expresia de dependență va fi evaluată după ce monitorul pentru ieșirea din serviciu sau după primirea unei capcane. O alertă va fi trimisă numai dacă evaluarea reușește, ceea ce înseamnă că niciunul dintre nodurile din graficul de dependență nu indică o eșec. <P> <B>Monitorizarea suprimării</b> . Dacă este setat pe „m”, atunci expresia de dependență va fi evaulată înainte ca monitorul pentru serviciu să fie executat. Dacă evaularea reușește, monitorul va fi rulat. În caz contrar, monitorul nu va fi rulat și starea serviciului va rămâne aceeași. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Definiții de perioadă </H3><P> Perioadele sunt utilizate pentru a defini condițiile care ar trebui să permită livrarea alertelor. <P><DL COMPACT><DT> <B>perioada</b> <I>[eticheta:] period</i> <DD> O perioadă grupează una sau mai multe alarme și variabile care controlează cât de des se produce o alertă atunci când există o defecțiune. Cuvântul cheie de <B>perioadă</b> are două forme. Primul are un argument care este o specificație a perioadei din modulul Patrick Ryan Time :: Period Perl 5. Consultați „Perldoc Time :: Period” pentru mai multe informații. <P> A doua formă necesită o etichetă urmată de o specificație de perioadă, așa cum este definită mai sus. Eticheta este o etichetă care constă dintr-un caracter alfabetic sau subliniere urmată de zero sau mai multe alfanumerice sau sublinieri și care se termină cu două puncte. Acest formular permite mai multe perioade cu aceeași definiție a perioadei. O utilizare este de a avea o definiție perioadă care nu are <B>alertafter</b> sau <B>alertevery</b> parametri pentru o anumită perioadă de timp, și un altul pentru aceeași perioadă de timp , cu un set diferit de alerte care nu conțin acești parametri. <P><DT> <B>perioada de timp</b> <I>alertevery</i> <DD> <B>Cuvântul</b> cheie <B>alertevery</b> (într-o definiție de <B>perioadă</b> ) ia același tip de argument ca variabila de <B>interval</b> și limitează numărul de ori este trimisă o alertă atunci când serviciul continuă să eșueze. De exemplu, dacă intervalul este &quot;1h&quot;, atunci doar alertele din secțiunea de perioade vor fi declanșate doar o dată în fiecare oră. Dacă un cuvânt cheie <B>alertevery</b> este omis într-o intrare de perioadă, o alertă va fi trimisă la fiecare detectare a unei defecțiuni. În mod implicit, dacă se modifică ieșirea a două eșecuri succesive, atunci intervalul de retragere este anulat. Dacă cuvântul „rezumat” este ultimul argument, atunci se vor lua în considerare numai liniile de ieșire sumare atunci când se compară ieșirea de eșecuri succesive. <P><DT> <B>alertafter</b> <I>num</i> <DD><P><DT> <B>alertafter</b> <I>numval timeval</i> <DD> <B>Cuvântul</b> cheie <B>alertafter</b> (într-o secțiune de <B>perioadă</b> ) are două forme: numai cu argumentul &quot;num&quot; sau cu argumentele &quot;numval time&quot;. În prima formă, o alertă va fi invocată numai după eșecurile consecutive „numerotate”. <P> În a doua formă, argumentele sunt un număr întreg pozitiv urmat de un interval, așa cum este descris de variabila de <B>interval de</b> mai sus. Dacă acești parametri sunt specificați, atunci alertele pentru acea perioadă vor fi apelate numai după ce se întâmplă multe eșecuri în acel interval. De exemplu, dacă <B>alertafterul</b> este dat cu argumentele „3 30m”, atunci alerta va fi apelată dacă se vor întâmpla 3 eșecuri în termen de 30 de minute. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Această variabilă spune serverului să nu apeleze mai mult decât alerte <I>numerice</i> în timpul unei defecțiuni. Contorul de alertă este păstrat pe fiecare perioadă și este resetat la fiecare succes. <P><DT> <B>comp_alerts</b> <DD><P> Dacă această opțiune este specificată, atunci alertele vor fi apelate numai dacă a fost apelată o alertă „jos” corespunzătoare. <P><DT> <B>alertă de</b> <I>alertă [arg ...]</i> <DD> O perioadă poate conține mai multe alerte, care sunt declanșate la eșecul serviciului. O alertă este specificată cu cuvântul cheie de <B>alertă</b> , urmat de un parametru de <B>ieșire</b> opțional și argumente care sunt interpretate la fel ca definiția <B>monitorului</b> , dar fără „;;” excepție. Parametrul de <B>ieșire</b> are forma de <B>ieșire = x</b> sau de <B>ieșire = xy</b> și are efectul că alerta este apelată numai dacă starea de ieșire a scriptului monitorului se încadrează în domeniul parametrului de <B>ieșire</b> . Dacă, de exemplu, linia de alertă este <I>alertă ieșire = 10-20 mail.alert mis</i> atunci <I>alertă prin poștă</i> va fi invocată cu <I>mis</i> ca argumente ale acesteia dacă valoarea de ieșire a programului de monitorizare este cuprinsă între 10 și 20. Această caracteristică vă permite să declanșați alerte diferite la niveluri de severitate diferite (ca atunci când spațiul liber pe disc trece de la 8% la 3%). <P> Consultați secțiunea <B>ALERT PROGRAMS de</b> mai sus pentru o listă de premaeters mon care va trece automat la programele de alertă. <P><DT> <I>alertă</i> <B>upalert</b> <I>[arg ...]</i> <DD> Un <B>răstimp</b> este complimentul unei <B>alerte</b> . Un upalert este apelat atunci când un serviciu face trecerea de la stat de la eșec la succes. Scriptul <B>upalert</b> se numește furnizarea acelorași parametri ca scriptul de <B>alertă</b> , cu adăugarea parametrului <B>-u,</b> care este pur și simplu utilizat pentru a anunța un script de alertă că este apelat ca un upalert. Pot fi specificate mai multe modificări pentru fiecare definiție a perioadei. Vă rugăm să rețineți că comportamentul implicit este acela că un upalert va fi trimis indiferent dacă au existat alerte anterioare „down” trimise, deoarece alertele sunt declanșate la o tranziție de stare. Setați opțiunea <B>comp_alerts</b> per- <B>period</b> pentru a asocia perechi ascendenți cu alerte „în jos”. <P><DT> <I>alertă</i> <B>startupalert</b> <I>[arg ...]</i> <DD> Un <B>startupalert</b> este apelat doar atunci când serverul <B>mon</b> începe executarea. <P><DT> <B>upalertafter</b> <I>timeval</i> <DD> Parametrul <B>upalertafter</b> este specificat ca o șir care urmează sintaxa parametrului de <B>interval</b> (&quot;30s&quot;, &quot;1m&quot;, etc.) și controlează declanșarea unui <B>upalert</b> . Dacă un serviciu revine după ce a fost coborât pentru o perioadă mai mare sau egală cu valoarea acestei opțiuni, se va <B>apela la</b> un apel. Utilizați această opțiune pentru a împiedica apelurile ascendente din cauza „blips-urilor” (scurte întreruperi). <P>