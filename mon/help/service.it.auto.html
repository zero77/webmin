<header> Aiuto MON sulle definizioni di servizio </header><p> Questa è la seconda e ultima fase per la configurazione MON. <p> I valori predefiniti vengono visualizzati per i servizi obbligatori <marked in RED color> . Vedere il rispettivo argomento della guida di seguito per ulteriori informazioni sulle definizioni del servizio. <p> Per <b>&quot;mail.alert&quot;</b> , assicurarsi che sendmail sia configurato e che il deamon <b>&quot;sendmail&quot;</b> sia avviato sulla macchina host. <H3> Definizioni di servizio </H3><P><DL COMPACT><DT> <B>servizio</b> <I>nome</i> <B>servizio</b> <DD> Una definizione di servizio inizia con il loro <B>servizio di</b> parole chiave seguito da una parola che è il tag per questo servizio. <P> I componenti di un servizio sono un intervallo, un monitor e una o più definizioni di periodi di tempo, come definito di seguito. <P> Se un nome di servizio &quot;predefinito&quot; è definito all&#39;interno di un gruppo di controllo chiamato &quot;dafault&quot; (vedere sopra), la definizione predefinita / predefinita verrà utilizzata per la gestione di trappole sconosciute. <P><DT> <B>intervallo</b> <I>timeval</i> <DD> L&#39; <B>intervallo di</b> parole chiave seguito da un valore temporale specifica la frequenza con cui verrà attivato uno script di monitoraggio. I valori temporali sono definiti come &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot; o &quot;1d&quot;, che significa 30 secondi, 5 minuti, 1 ora o 1 giorno. La porzione numerica può essere una frazione, ad esempio &quot;1,5 ore&quot; o un&#39;ora e mezza. Questo formato di una specifica temporale verrà definito <I>timeval</i> . <P><DT> <B>traptimeout</b> <I>timeval</i> <DD> Questa parola chiave impiega lo stesso tempo specifica argomento come <B><I>intervallo,</i></b> e rende il servizio aspettarsi una trappola da una sorgente esterna almeno che spesso, altrimenti verrà registrato un errore. Viene utilizzato per un servizio in stile heartbeat. <P><DT> <B>trapduration</b> <I>timeval</i> <DD> Se viene ricevuta una trap, lo stato del servizio a cui è stata consegnata la trap rimarrà normalmente costante. Se viene specificato <B>trapduration</b> , lo stato del servizio rimarrà in uno stato di errore per la durata specificata da <I>timeval</i> , quindi verrà reimpostato su &quot;esito positivo&quot;. <P><DT> <I>timeval</i> <B>randskew</b> <DD> Invece di pianificare l&#39;esecuzione dello script monitor all&#39;inizio di ciascun intervallo, regolare in modo casuale l&#39;intervallo specificato dal parametro <B>intervallo</b> mediante il <B>randskew</b> più o meno <B>.</b> Il valore dell&#39;inclinazione è specificato come parametro <B>dell&#39;intervallo</b> : &quot;30s&quot;, &quot;5m&quot;, ecc ... Ad esempio, se l&#39; <B>intervallo</b> è 1m e il <B>randskew</b> è &quot;5s&quot;, allora <I>mon</i> programmerà lo script di monitoraggio tra 55 minuti e ogni 65 secondi. L&#39;intento è di aiutare a distribuire il carico sul server quando molti servizi sono programmati agli stessi intervalli. <P><DT> <B>monitor</b> <I>monitor-name [arg ...]</i> <DD> Il <B>monitor delle</b> parole chiave seguito da un nome di script e argomenti specifica il monitor da eseguire alla scadenza del timer. Le convenzioni di quotazione simili a shell vengono seguite quando si specificano gli argomenti da inviare allo script monitor. Lo script viene richiamato dalla directory fornita con l&#39;argomento <B>-s</b> e tutte le parole seguenti vengono fornite come argomenti al programma monitor, seguite dall&#39;elenco di host nel gruppo a cui fa riferimento l&#39;attuale gruppo di controllo. Se la linea del monitor termina con &quot;;;&quot; come parola separata, i gruppi host non vengono aggiunti all&#39;elenco degli argomenti quando viene invocato il programma. <P><DT> <B>allow_empty_group</b> <DD> L&#39;opzione <B>allow_empty_group</b> consentirà di invocare un monitor anche quando il gruppo host per quell&#39;orologio è vuoto a causa di host disabilitati. Il comportamento predefinito non è invocare il monitor quando tutti gli host in un gruppo host sono stati disabilitati. <P><DT> <B>descrizione</b> <I>descrizione testo</i> <DD> Il testo che segue <B>descrizione</b> viene interrogato dai programmi client, passati agli avvisi e monitor tramite una variabile di ambiente. Dovrebbe contenere una breve descrizione del servizio, adatta per essere inclusa in un&#39;e-mail o in una pagina Web. <P><DT> <B>exclude_hosts</b> <I>host [host ...]</i> <DD> Qualsiasi host elencato dopo <B>exclude_hosts</b> verrà escluso dal controllo del servizio. <P><DT> <B>exclude_period</b> <I>periodspec</i> <DD> Non eseguire un monitor programmato durante il tempo identificato da <I>periodpec</i> . <P><DT> <B>dipende dalla</b> <I>dependexpression</i> <DD> La parola chiave <B>depend</b> viene utilizzata per specificare un&#39;espressione di dipendenza, che valuta true o false, in senso booleano. Le dipendenze sono espressioni Perl effettive e devono rispettare tutte le regole sintattiche. Le espressioni vengono valutate nel proprio spazio del pacchetto in modo da non avere accidentalmente effetti collaterali indesiderati. Se viene rilevato un errore di sintassi durante la valutazione dell&#39;espressione, viene registrato tramite syslog. <P> Prima della valutazione, si verificano le seguenti sostituzioni sull&#39;espressione: le frasi che assomigliano a &quot;gruppo: servizio&quot; sono sostituite con il valore dell&#39;attuale stato operativo di quel servizio specificato. Queste sostituzioni di opstatus sono calcolate in modo ricorsivo, quindi se il servizio A dipende dal servizio B e il servizio B dipende dal servizio C, il servizio A dipende dal servizio C. Gli stati operativi di successo (che valutano &quot;1&quot;) sono &quot;STAT_OK&quot;, &quot;STAT_COLDSTART &quot;,&quot; STAT_WARMSTART &quot;e&quot; STAT_UNKNOWN &quot;. La parola &quot;SELF&quot; (in maiuscolo) può essere utilizzata per il gruppo (ad es. &quot;SELF: servizio&quot;), ed è un&#39;abbreviazione per il gruppo di orologi corrente. <P> Questa funzione può essere utilizzata per controllare gli avvisi per servizi che dipendono da altri servizi, ad esempio un test SMTP che dipende dal fatto che la macchina sia raggiungibile tramite ping. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> La valutazione dei grafici delle dipendenze può controllare la soppressione di allarmi o monitorare le invocazioni. <P> <B>Soppressione avviso</b> . Se questa opzione è impostata su &quot;a&quot;, l&#39;espressione di dipendenza verrà valutata dopo l&#39;uscita del monitor per il servizio o dopo la ricezione di una trap. Un avviso verrà inviato solo se la valutazione ha esito positivo, il che significa che nessuno dei nodi nel grafico delle dipendenze indica un errore. <P> <B>Monitorare la soppressione</b> . Se è impostato su &quot;m&quot;, l&#39;espressione di dipendenza verrà evocata prima che il monitor per il servizio stia per essere eseguito. Se l&#39;evacuazione ha esito positivo, verrà eseguito il monitor. In caso contrario, il monitor non verrà eseguito e lo stato del servizio rimarrà lo stesso. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Definizioni del periodo </H3><P> I periodi vengono utilizzati per definire le condizioni che dovrebbero consentire l&#39;invio di avvisi. <P><DL COMPACT><DT> <B>period</b> <I>[etichetta:] periodpec</i> <DD> Un periodo raggruppa uno o più allarmi e variabili che controllano la frequenza con cui si verifica un avviso in caso di errore. La parola chiave del <B>periodo</b> ha due forme. Il primo prende un argomento che è una specifica del periodo dal modulo Time :: Period Perl 5 di Patrick Ryan. Fare riferimento a &quot;perldoc Time :: Period&quot; per ulteriori informazioni. <P> Il secondo modulo richiede un&#39;etichetta seguita da una specifica del periodo, come definito sopra. L&#39;etichetta è un tag composto da un carattere alfabetico o da un trattino basso seguito da zero o più caratteri alfanumerici o di sottolineatura e termina con due punti. Questo modulo consente più periodi con la stessa definizione di periodo. Un uso è avere una definizione di periodo che non ha parametri <B>alertafter</b> o <B>alertevery</b> per un determinato periodo di tempo, e un altro per lo stesso periodo di tempo con un diverso set di avvisi che contenga tali parametri. <P><DT> <B>alertevery</b> <I>timeval</i> <DD> La parola chiave <B>alertevery</b> (all&#39;interno di una definizione di <B>periodo</b> ) accetta lo stesso tipo di argomento della variabile <B>intervallo</b> e limita il numero di volte in cui viene inviato un avviso quando il servizio continua a fallire. Ad esempio, se l&#39;intervallo è &quot;1h&quot;, solo gli avvisi nella sezione periodo verranno attivati una volta ogni ora. Se la parola chiave <B>alertevery</b> viene omessa in una voce del periodo, verrà inviato un avviso ogni volta che viene rilevato un errore. Per impostazione predefinita, se l&#39;output di due errori successivi cambia, l&#39;intervallo di alertevery viene ignorato. Se la parola &quot;riepilogo&quot; è l&#39;ultimo argomento, verranno prese in considerazione solo le righe di output di riepilogo quando si confronta l&#39;output di errori successivi. <P><DT> <B>alertafter</b> <I>num</i> <DD><P><DT> <B>alertafter</b> <I>num timeval</i> <DD> La parola chiave <B>alertafter</b> (all&#39;interno di una sezione del <B>periodo</b> ) ha due forme: solo con l&#39;argomento &quot;num&quot; o con gli argomenti &quot;num timeval&quot;. Nel primo modulo, un avviso verrà richiamato solo dopo &quot;num&quot; errori consecutivi. <P> Nella seconda forma, gli argomenti sono un numero intero positivo seguito da un intervallo, come descritto dalla variabile <B>intervallo</b> sopra. Se vengono specificati questi parametri, gli avvisi per quel periodo verranno richiamati solo dopo che si sono verificati molti guasti entro quell&#39;intervallo. Ad esempio, se <B>alertafter</b> vengono forniti gli argomenti &quot;3 30m&quot;, verrà chiamato l&#39;avviso se si verificano 3 guasti entro 30 minuti. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Questa variabile indica al server di chiamare non più di <I>num</i> avvisi durante un errore. Il contatore degli avvisi viene mantenuto su base periodica e viene reimpostato ad ogni successo. <P><DT> <B>comp_alerts</b> <DD><P> Se questa opzione è specificata, gli upalert saranno chiamati solo se è stato chiamato un corrispondente avviso &quot;down&quot;. <P><DT> <B>alert</b> <I>alert [arg ...]</i> <DD> Un periodo può contenere più avvisi, che vengono attivati in caso di errore del servizio. Un avviso viene specificato con la parola chiave <B>alert</b> , seguito da un parametro di <B>uscita</b> opzionale e argomenti interpretati come la definizione del <B>monitor</b> , ma senza &quot;;;&quot; eccezione. Il parametro <B>exit</b> assume la forma di <B>exit = x</b> o <B>exit = xy</b> e ha l&#39;effetto che l&#39;avviso viene chiamato solo se lo stato di uscita dello script monitor rientra nell&#39;intervallo del parametro di <B>uscita</b> . Se, ad esempio, la riga di avviso è <I>alert exit = 10-20 mail.alert mis,</i> allora <I>mail-alert</i> sarà invocato con <I>mis</i> come argomenti solo se il valore di uscita del programma di monitoraggio è compreso tra 10 e 20. Questa funzione consente di attivare avvisi diversi a diversi livelli di gravità (come quando lo spazio libero su disco va dall&#39;8% al 3%). <P> Vedi la sezione <B>PROGRAMMI DI AVVISO</b> sopra per un elenco dei pramaeter mon passerà automaticamente ai programmi di allarme. <P><DT> <B>upalert</b> <I>alert [arg ...]</i> <DD> Un <B>upalert</b> è il complimento di un <B>avviso</b> . Un upalert viene chiamato quando un servizio effettua la transizione di stato da un fallimento a un successo. Lo script <B>upalert</b> viene chiamato fornendo gli stessi parametri dello script di <B>avviso</b> , con l&#39;aggiunta del parametro <B>-u</b> che viene semplicemente utilizzato per far sapere a uno script di avviso che viene chiamato come upalert. È possibile specificare più upalert per ciascuna definizione di periodo. Si noti che il comportamento predefinito è che un upalert verrà inviato indipendentemente dal fatto che siano stati inviati avvisi precedenti di &quot;down&quot;, poiché gli upalert vengono attivati durante una transizione di stato. Impostare l&#39;opzione <B>comp_alerts</b> per periodo per accoppiare upalerts con avvisi &quot;down&quot;. <P><DT> <B>startupalert</b> <I>alert [arg ...]</i> <DD> Un <B>startupalert</b> viene chiamato solo quando il server <B>mon</b> avvia l&#39;esecuzione. <P><DT> <B>upalertafter</b> <I>timeval</i> <DD> Il parametro <B>upalertafter</b> è specificato come una stringa che segue la sintassi del parametro <B>intervallo</b> (&quot;30s&quot;, &quot;1m&quot;, ecc.) E controlla l&#39;attivazione di un <B>upalert</b> . Se un servizio ritorna dopo essere stato inattivo per un tempo maggiore o uguale al valore di questa opzione, verrà chiamato un <B>upalert</b> . Utilizzare questa opzione per impedire che gli upalert vengano chiamati a causa di &quot;bip&quot; (brevi interruzioni). <P>