<header> Βοήθεια MON για ορισμούς υπηρεσίας </header><p> Αυτό είναι το δεύτερο και τελευταίο στάδιο για τη διαμόρφωση MON. <p> Οι προεπιλεγμένες τιμές εμφανίζονται για τις υποχρεωτικές υπηρεσίες <marked in RED color> . Δείτε το αντίστοιχο θέμα βοήθειας παρακάτω για περισσότερη βοήθεια σχετικά με τους ορισμούς υπηρεσιών. <p> Για το <b>&quot;mail.alert&quot;</b> , βεβαιωθείτε ότι το sendmail έχει ρυθμιστεί και ότι το <b>&quot;sendmail&quot;</b> ξεκινά στο hostmachine. <H3> Ορισμοί υπηρεσίας </H3><P><DL COMPACT><DT> <I>SERVICENAME</i> <B>υπηρεσία</b> <DD> Ένας ορισμός υπηρεσίας ξεκινά με την λέξη-κλειδί <B>υπηρεσία</b> ακολουθούμενη από μια λέξη που είναι η ετικέτα για αυτήν την υπηρεσία. <P> Τα στοιχεία μιας υπηρεσίας είναι ορισμοί διαστήματος, παρακολούθησης και ενός ή περισσότερων χρονικών περιόδων, όπως ορίζονται παρακάτω. <P> Εάν ένα όνομα υπηρεσίας &quot;προεπιλογή&quot; ορίζεται σε μια ομάδα παρακολούθησης που ονομάζεται &quot;dafault&quot; (βλέπε παραπάνω), τότε ο προεπιλεγμένος / προεπιλεγμένος ορισμός θα χρησιμοποιηθεί για το χειρισμό άγνωστων παγίδων. <P><DT> <B>διάστημα</b> <I>timeval</i> <DD> Το <B>διάστημα</b> λέξεων-κλειδιών <B>που</b> ακολουθείται από μια τιμή ώρας καθορίζει τη συχνότητα ενεργοποίησης ενός σεναρίου οθόνης. Οι τιμές χρόνου ορίζονται ως &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot; ή &quot;1d&quot;, που σημαίνει 30 δευτερόλεπτα, 5 λεπτά, 1 ώρα ή 1 ημέρα. Το αριθμητικό τμήμα μπορεί να είναι ένα κλάσμα, όπως &quot;1,5 ώρα&quot; ή μιάμιση ώρα. Αυτή η μορφή μιας προδιαγραφής ώρας θα αναφέρεται ως <I>χρονικό διάστημα</i> . <P><DT> <B>χρονικό</b> <I>διάστημα traptimeout</i> <DD> Αυτή η λέξη-κλειδί παίρνει την ίδια στιγμή επιχείρημα προδιαγραφές, όπως <B>το <I>διάστημα,</i></b> και καθιστά την υπηρεσία περιμένουμε μια παγίδα από μια εξωτερική πηγή, τουλάχιστον, που συχνά, αλλιώς θα πρέπει να καταχωρηθεί μια αποτυχία. Χρησιμοποιείται για μια υπηρεσία τύπου καρδιακού παλμού. <P><DT> <B>χρονικό</b> <I>διάστημα παγίδευσης</i> <DD> Εάν ληφθεί παγίδα, η κατάσταση της υπηρεσίας στην οποία παραδόθηκε η παγίδα θα παραμείνει κανονικά σταθερή. Εάν έχει οριστεί η <B>παγίδα</b> , η κατάσταση της υπηρεσίας θα παραμείνει σε κατάσταση αποτυχίας για τη διάρκεια που καθορίζεται από το <I>χρονικό διάστημα</i> και, στη συνέχεια, θα επαναφερθεί σε &quot;επιτυχία&quot;. <P><DT> <B>χρονικό</b> <I>διάστημα randskew</i> <DD> Αντί να προγραμματίσετε την εκτέλεση του σεναρίου παρακολούθησης στην αρχή κάθε διαστήματος, προσαρμόστε τυχαία το διάστημα που καθορίζεται από την παράμετρο <B>διαστήματος</b> με συν-ή-μείον <B>randskew.</b> Η τιμή skew καθορίζεται ως παράμετρος <B>διαστήματος</b> : &quot;30s&quot;, &quot;5m&quot;, κλπ ... Για παράδειγμα, εάν το <B>διάστημα</b> είναι 1m και το <B>randskew</b> είναι &quot;5s&quot;, τότε το <I>mon</i> θα προγραμματίσει το σενάριο οθόνης κάποια στιγμή μεταξύ κάθε 55 δευτερολέπτων και 65 δευτερόλεπτα. Η πρόθεση είναι να βοηθήσουμε στη διανομή του φορτίου στο διακομιστή όταν προγραμματίζονται πολλές υπηρεσίες τα ίδια διαστήματα. <P><DT> <B>οθόνη</b> <I>οθόνη-όνομα [arg ...]</i> <DD> Το <B>μόνιτορ</b> λέξεων-κλειδιών ακολουθούμενο από ένα όνομα σεναρίου και ορίσματα καθορίζει την οθόνη που θα εκτελεστεί όταν λήξει ο χρονοδιακόπτης. Ακολουθούνται οι συμβάσεις παραπομπής με κέλυφος όταν καθορίζονται τα επιχειρήματα για αποστολή στο σενάριο οθόνης. Το σενάριο καλείται από τον κατάλογο που δίνεται με το όρισμα <B>-s</b> και όλες οι ακόλουθες λέξεις παρέχονται ως ορίσματα στο πρόγραμμα παρακολούθησης, ακολουθούμενη από τη λίστα των κεντρικών υπολογιστών στην ομάδα που αναφέρεται από την τρέχουσα ομάδα παρακολούθησης. Εάν η γραμμή παρακολούθησης τελειώνει με &quot;;;&quot; ως ξεχωριστή λέξη, οι ομάδες υποδοχής δεν επισυνάπτονται στη λίστα ορισμάτων κατά την κλήση του προγράμματος. <P><DT> <B>allow_empty_group</b> <DD> Η επιλογή <B>allow_empty_group</b> θα επιτρέψει σε μια οθόνη να κληθεί ακόμα και όταν η ομάδα φιλοξενίας για αυτό το ρολόι είναι κενή λόγω απενεργοποιημένων κεντρικών υπολογιστών. Η προεπιλεγμένη συμπεριφορά δεν είναι να επικαλεστεί την οθόνη όταν έχουν απενεργοποιηθεί όλοι οι κεντρικοί υπολογιστές σε μια ομάδα κεντρικών υπολογιστών. <P><DT> <B>περιγραφή</b> <I>περιγραφή κειμένου</i> <DD> Το κείμενο που ακολουθεί την <B>περιγραφή</b> υποβάλλεται σε ερώτηση από προγράμματα πελατών, διαβιβάζεται σε ειδοποιήσεις και οθόνες μέσω μιας μεταβλητής περιβάλλοντος. Θα πρέπει να περιέχει μια σύντομη περιγραφή της υπηρεσίας, κατάλληλη για συμπερίληψη σε email ή σε ιστοσελίδα. <P><DT> <B>exclude_hosts</b> <I>host [κεντρικός υπολογιστής ...]</i> <DD> Τυχόν κεντρικοί υπολογιστές που αναφέρονται μετά το <B>exclude_hosts</b> θα εξαιρούνται από τον έλεγχο υπηρεσίας. <P><DT> <B>exclude_period</b> <I>periodspec</i> <DD> Μην εκτελείτε μια προγραμματισμένη οθόνη κατά τη διάρκεια του χρόνου που προσδιορίζεται από <I>periodpec</i> . <P><DT> <B>εξαρτάται</b> <I>εξαρτημένη έκφραση</i> <DD> Η <B>εξαρτώνται</b> λέξη-κλειδί χρησιμοποιείται για να καθορίσει μια έκφραση της εξάρτησης, η οποία αξιολογείται αληθής ψευδών, στη δυαδική λογική. Οι εξαρτήσεις είναι πραγματικές εκφράσεις Perl και πρέπει να τηρούν όλους τους συντακτικούς κανόνες. Οι εκφράσεις αξιολογούνται στον δικό τους χώρο πακέτου έτσι ώστε να μην έχουν τυχαία κάποια ανεπιθύμητη παρενέργεια. Εάν εντοπιστεί σφάλμα σύνταξης κατά την αξιολόγηση της έκφρασης, καταγράφεται μέσω syslog. <P> Πριν από την αξιολόγηση, εμφανίζονται οι ακόλουθες αντικαταστάσεις στην έκφραση: φράσεις που μοιάζουν με &quot;ομάδα: υπηρεσία&quot; αντικαθίστανται με την αξία της τρέχουσας επιχειρησιακής κατάστασης αυτής της καθορισμένης υπηρεσίας. Αυτές οι υποκαταστάσεις opstatus υπολογίζονται αναδρομικά, οπότε εάν η υπηρεσία A εξαρτάται από την υπηρεσία B και η υπηρεσία B εξαρτάται από την υπηρεσία C, τότε η υπηρεσία A εξαρτάται από την υπηρεσία C. Οι επιτυχημένες λειτουργικές καταστάσεις (οι οποίες αξιολογούνται σε &quot;1&quot;) είναι &quot;STAT_OK&quot;, &quot;STAT_COLDSTART &quot;,&quot; STAT_WARMSTART &quot;και&quot; STAT_UNKNOWN &quot;. Η λέξη &quot;SELF&quot; (σε όλα τα κεφαλαία) μπορεί να χρησιμοποιηθεί για την ομάδα (π.χ. &quot;SELF: service&quot;) και αποτελεί συντομογραφία για την τρέχουσα ομάδα παρακολούθησης. <P> Αυτή η δυνατότητα μπορεί να χρησιμοποιηθεί για τον έλεγχο ειδοποιήσεων για υπηρεσίες που εξαρτώνται από άλλες υπηρεσίες, π.χ. μια δοκιμή SMTP που εξαρτάται από το ότι το μηχάνημα είναι προσβάσιμο σε ping. <P><DT> <B>dep_behavior</b> <I>{α | m}</i> <DD> Η αξιολόγηση των γραφημάτων εξάρτησης μπορεί να ελέγξει την καταστολή είτε των ειδοποιήσεων είτε της παρακολούθησης. <P> <B>Καταστολή προειδοποίησης</b> . Εάν αυτή η επιλογή έχει οριστεί σε &quot;a&quot;, τότε η έκφραση εξάρτησης θα αξιολογηθεί μετά την έξοδο της οθόνης για την υπηρεσία ή μετά τη λήψη παγίδας. Μια ειδοποίηση θα σταλεί μόνο εάν η αξιολόγηση επιτύχει, πράγμα που σημαίνει ότι κανένας από τους κόμβους στο γράφημα εξάρτησης δεν δείχνει αποτυχία. <P> <B>Παρακολούθηση καταστολής</b> . Εάν έχει οριστεί σε &quot;m&quot;, τότε η έκφραση της εξάρτησης θα εξελιχθεί πριν από την εκτέλεση της οθόνης για την υπηρεσία. Εάν η εκτύπωση επιτύχει, τότε η οθόνη θα εκτελεστεί. Διαφορετικά, η οθόνη δεν θα εκτελεστεί και η κατάσταση της υπηρεσίας θα παραμείνει η ίδια. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Ορισμοί περιόδου </H3><P> Οι περίοδοι χρησιμοποιούνται για τον καθορισμό των συνθηκών που επιτρέπουν την παράδοση ειδοποιήσεων. <P><DL COMPACT><DT> <B>περίοδος</b> <I>[ετικέτα:] periodpec</i> <DD> Μια περίοδος ομαδοποιεί έναν ή περισσότερους συναγερμούς και μεταβλητές που ελέγχουν πόσο συχνά συμβαίνει μια ειδοποίηση όταν υπάρχει αποτυχία. Η λέξη-κλειδί <B>περιόδου</b> έχει δύο μορφές. Το πρώτο παίρνει ένα επιχείρημα που είναι μια προδιαγραφή περιόδου από την ενότητα Time :: Period Perl 5 του Patrick Ryan. Ανατρέξτε στο &quot;perldoc Time :: Period&quot; για περισσότερες πληροφορίες. <P> Η δεύτερη φόρμα απαιτεί μια ετικέτα ακολουθούμενη από μια προδιαγραφή περιόδου, όπως ορίζεται παραπάνω. Η ετικέτα είναι μια ετικέτα που αποτελείται από αλφαβητικό χαρακτήρα ή υπογράμμιση που ακολουθείται από μηδέν ή περισσότερα αλφαριθμητικά ή κάτω παύλες και τελειώνει με άνω και κάτω τελεία. Αυτή η φόρμα επιτρέπει πολλές περιόδους με τον ίδιο ορισμό περιόδου. Μία χρήση είναι να έχουμε έναν ορισμό περιόδου που να μην έχει <B>ειδοποίηση μετά από</b> ή να <B>ειδοποιεί κάθε</b> παράμετρο για μια συγκεκριμένη χρονική περίοδο και μια άλλη για την ίδια χρονική περίοδο με ένα διαφορετικό σύνολο ειδοποιήσεων που περιέχει αυτές τις παραμέτρους. <P><DT> <B>προειδοποίηση</b> <I>κάθε</i> <B>χρονικό</b> <I>διάστημα</i> <DD> Η <B>κάθε</b> λέξη-κλειδί <B>ειδοποίησης</b> (εντός ορισμού <B>περιόδου</b> ) παίρνει τον ίδιο τύπο ορίσματος με τη μεταβλητή <B>διαστήματος</b> και περιορίζει τον αριθμό των φορών που αποστέλλεται μια ειδοποίηση όταν η υπηρεσία συνεχίζει να αποτυγχάνει. Για παράδειγμα, εάν το διάστημα είναι &quot;1 ώρα&quot;, τότε μόνο οι ειδοποιήσεις στην ενότητα περιόδου ενεργοποιούνται μόνο μία φορά κάθε ώρα. Εάν η <B>προειδοποίηση κάθε</b> λέξη-κλειδί παραλείπεται σε μια καταχώρηση περιόδου, μια ειδοποίηση θα αποστέλλεται κάθε φορά που εντοπίζεται μια αποτυχία. Από προεπιλογή, εάν αλλάξει η έξοδος δύο διαδοχικών αποτυχιών, τότε το διάστημα ειδοποίησης παρακάμπτεται. Εάν η λέξη &quot;περίληψη&quot; είναι το τελευταίο επιχείρημα, τότε μόνο οι γραμμές εξόδου περίληψης θα λαμβάνονται υπόψη κατά τη σύγκριση της εξόδου διαδοχικών αποτυχιών. <P><DT> <B>alert μετά τον</b> <I>αριθμό</i> <DD><P><DT> <B>χρονικό</b> <I>διάστημα</i> <B>ειδοποίησης μετά τον</b> <I>αριθμό</i> <DD> Η λέξη-κλειδί <B>alert μετά</b> (εντός ενότητας <B>περιόδου</b> ) έχει δύο μορφές: μόνο με το όρισμα &quot;num&quot; ή με τα ορίσματα &quot;num timeval&quot;. Στην πρώτη φόρμα, μια ειδοποίηση θα κληθεί μόνο μετά από διαδοχικές αποτυχίες &quot;num&quot;. <P> Στη δεύτερη μορφή, τα ορίσματα είναι ένας θετικός ακέραιος ακολουθούμενος από ένα διάστημα, όπως περιγράφεται από τη μεταβλητή <B>διαστήματος</b> παραπάνω. Εάν έχουν καθοριστεί αυτές οι παράμετροι, τότε οι ειδοποιήσεις για αυτήν την περίοδο θα κληθούν μόνο αφού συμβούν πολλές αστοχίες εντός αυτού του διαστήματος. Για παράδειγμα, εάν <B>δοθεί ειδοποίηση</b> μετά από τα επιχειρήματα &quot;3 30m&quot;, τότε η ειδοποίηση θα κληθεί εάν συμβούν 3 αστοχίες εντός 30 λεπτών. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Αυτή η μεταβλητή λέει στον διακομιστή να καλεί όχι μόνο ειδοποιήσεις <I>αριθμού</i> κατά τη διάρκεια μιας αποτυχίας. Ο μετρητής προειδοποίησης διατηρείται ανά περίοδο, και επαναφέρεται σε κάθε επιτυχία. <P><DT> <B>comp_alerts</b> <DD><P> Εάν έχει οριστεί αυτή η επιλογή, τότε θα πραγματοποιούνται κλήσεις προς τα επάνω, εάν έχει κληθεί αντίστοιχη ειδοποίηση &quot;προς τα κάτω&quot;. <P><DT> <B>προειδοποίηση</b> <I>ειδοποίησης [arg ...]</i> <DD> Μια περίοδος μπορεί να περιέχει πολλές ειδοποιήσεις, οι οποίες ενεργοποιούνται μετά την αποτυχία της υπηρεσίας. Μια προειδοποίηση καθορίζεται με τη λέξη-κλειδί <B>ειδοποίησης</b> , ακολουθούμενη από ένα προαιρετικό παράμετρο <B>εξόδου</b> , και επιχειρήματα που ερμηνεύονται το ίδιο με τον ορισμό της <B>οθόνης</b> , αλλά χωρίς το &quot;;;&quot; εξαίρεση. Η παράμετρος <B>εξόδου</b> έχει τη μορφή <B>εξόδου = x</b> ή <B>έξοδος = xy</b> και έχει ως αποτέλεσμα ότι η ειδοποίηση καλείται μόνο εάν η κατάσταση εξόδου του σεναρίου παρακολούθησης εμπίπτει στο εύρος της παραμέτρου <B>εξόδου</b> . Εάν, για παράδειγμα, η γραμμή προειδοποίησης είναι <I>έξοδος ειδοποίησης = 10-20 mail.alert mis</i> τότε <I>η ειδοποίηση αλληλογραφίας</i> θα κληθεί μόνο με <I>mis</i> ως ορίσματά της, εάν η τιμή εξόδου του προγράμματος παρακολούθησης είναι μεταξύ 10 και 20. Αυτή η δυνατότητα σάς επιτρέπει να ενεργοποιήσετε διαφορετικές ειδοποιήσεις σε διαφορετικά επίπεδα σοβαρότητας (όπως όταν ο ελεύθερος χώρος στο δίσκο κυμαίνεται από 8% σε 3%). <P> Δείτε την παραπάνω ενότητα <B>ΠΡΟΓΡΑΜΜΑΤΩΝ ΠΡΟΕΙΔΟΠΟΙΗΣΗΣ</b> για μια λίστα των προμετρητών που θα περάσει αυτόματα σε προγράμματα ειδοποίησης. <P><DT> <B>upalert</b> <I>ειδοποίηση [arg ...]</i> <DD> Το <B>upalert</b> είναι το κομπλιμέντο μιας <B>ειδοποίησης</b> . Ένα upalert καλείται όταν μια υπηρεσία κάνει το κράτος μετάβαση από αποτυχία σε επιτυχία. Το σενάριο <B>upalert</b> καλείται να παρέχει τις ίδιες παραμέτρους με το σενάριο <B>ειδοποίησης</b> , με την προσθήκη της παραμέτρου <B>-u</b> που χρησιμοποιείται απλά για να ενημερώσει ένα σενάριο ειδοποίησης ότι καλείται ως upalert. Μπορούν να καθοριστούν πολλαπλές αναβαθμίσεις για κάθε ορισμό περιόδου. Λάβετε υπόψη ότι η προεπιλεγμένη συμπεριφορά είναι ότι θα αποστέλλεται ένας upalert ανεξάρτητα από το εάν είχαν αποσταλεί προηγούμενες ειδοποιήσεις &quot;down&quot;, καθώς οι upalerts ενεργοποιούνται σε κατάσταση μετάβασης. Ορίστε την επιλογή ανά περίοδο <B>comp_alerts</b> για σύζευξη των upalerts με &quot;down&quot; ειδοποιήσεις. <P><DT> <I>ειδοποίηση</i> <B>startupalert</b> <I>[arg ...]</i> <DD> Ένα <B>startupalert</b> καλείται μόνο όταν ο διακομιστής <B>mon</b> ξεκινά την εκτέλεση. <P><DT> <B>χρονικό</b> <I>διάστημα</i> <B>μετά το</b> <I>τέλος</i> <DD> Η παράμετρος <B>upalertafter</b> καθορίζεται ως συμβολοσειρά που ακολουθεί τη σύνταξη της παραμέτρου <B>διαστήματος</b> (&quot;30s&quot;, &quot;1m&quot;, κ.λπ.) και ελέγχει την ενεργοποίηση ενός <B>upalert</b> . Εάν μια υπηρεσία επανέλθει μετά την απενεργοποίηση για χρονικό διάστημα μεγαλύτερο ή ίσο με την τιμή αυτής της επιλογής, θα κληθεί ένα <B>upertert</b> . Χρησιμοποιήστε αυτήν την επιλογή για να αποφύγετε την κλήση των upalerts λόγω &quot;blips&quot; (σύντομες διακοπές λειτουργίας). <P>