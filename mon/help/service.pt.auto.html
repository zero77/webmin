<header> Ajuda do MON sobre definições de serviço </header><p> Este é o segundo e o último estágio da configuração do MON. <p> Os valores padrão são mostrados para os serviços obrigatórios <marked in RED color> . Consulte o respectivo tópico de ajuda abaixo para obter mais ajuda sobre as Definições de Serviço. <p> Para <b>&quot;mail.alert&quot;</b> , verifique se o sendmail está configurado e o deamon <b>&quot;sendmail&quot;</b> foi iniciado na máquina host. <H3> Definições de serviço </H3><P><DL COMPACT><DT> <B>service</b> <I>servicename</i> <DD> Uma definição de serviço começa com a palavra-chave <B>service,</b> seguida por uma palavra que é a tag desse serviço. <P> Os componentes de um serviço são um intervalo, monitor e uma ou mais definições de período, conforme definido abaixo. <P> Se um nome de serviço &quot;padrão&quot; for definido dentro de um grupo de observação chamado &quot;padrão&quot; (veja acima), a definição padrão / padrão será usada para lidar com traps mon monitores desconhecidos. <P><DT> <B>intervalo</b> <I>temporal</i> <DD> O <B>intervalo da</b> palavra-chave seguido por um valor de tempo especifica a frequência em que um script de monitor será acionado. Os valores de tempo são definidos como &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot; ou &quot;1d&quot;, o que significa 30 segundos, 5 minutos, 1 hora ou 1 dia. A parte numérica pode ser uma fração, como &quot;1,5 h&quot; ou uma hora e meia. Este formato de uma especificação de tempo será chamado de <I>timeval</i> . <P><DT> <B>traptimeout</b> <I>timeval</i> <DD> Esta palavra-chave tem o mesmo argumento de especificação de tempo de <B><I>intervalo,</i></b> e faz com que o serviço de esperar uma armadilha de um provedor externo, pelo menos, que muitas vezes, senão uma falha será registrado. Isso é usado para um serviço no estilo de pulsação. <P><DT> <B>trapduration</b> <I>timeval</i> <DD> Se uma captura for recebida, o status do serviço para o qual a captura foi entregue permanecerá normalmente constante. Se a <B>trapduração</b> for especificada, o status do serviço permanecerá em um estado de falha pela duração especificada por <I>timeval</i> e, em seguida, será redefinido para &quot;êxito&quot;. <P><DT> <B>randskew</b> <I>timeval</i> <DD> Em vez de agendar o script do monitor para ser executado no início de cada intervalo, ajuste aleatoriamente o intervalo especificado pelo parâmetro <B>interval</b> por mais ou menos menos o <B>randskew.</b> O valor de inclinação é especificado como o parâmetro do <B>intervalo</b> : &quot;30s&quot;, &quot;5m&quot;, etc ... Por exemplo, se o <B>intervalo</b> for 1m e o <B>randskew</b> for &quot;5s&quot;, então <I>mon</i> agendará o script do monitor algum tempo entre cada 55 segundos e 65 segundos. A intenção é ajudar a distribuir a carga no servidor quando muitos serviços são agendados nos mesmos intervalos. <P><DT> <B>monitorar</b> <I>nome do monitor [arg ...]</i> <DD> O <B>monitor de</b> palavras-chave seguido por um nome de script e argumentos especifica que o monitor seja executado quando o cronômetro expirar. As convenções de cotação do tipo shell são seguidas ao especificar os argumentos a serem enviados ao script de monitor. O script é chamado a partir do diretório fornecido com o argumento <B>-s</b> , e todas as palavras a seguir são fornecidas como argumentos para o programa monitor, seguidas pela lista de hosts no grupo referido pelo grupo de observação atual. Se a linha do monitor terminar com &quot;;;&quot; como uma palavra separada, os grupos de hosts não são anexados à lista de argumentos quando o programa é chamado. <P><DT> <B>allow_empty_group</b> <DD> A opção <B>allow_empty_group</b> permitirá que um monitor seja chamado mesmo quando o grupo de host para esse relógio estiver vazio por causa de hosts desativados. O comportamento padrão é não chamar o monitor quando todos os hosts em um grupo de hosts estiverem desativados. <P><DT> <B>description</b> <I>descriptiontext</i> <DD> O texto seguinte <B>descrição</b> é consultado por programas clientes, passados para alertas e monitores através de uma variável de ambiente. Ele deve conter uma breve descrição do serviço, adequado para inclusão em um email ou em uma página da web. <P><DT> <I>host</i> <B>exclude_hosts</b> <I>[host ...]</i> <DD> Quaisquer hosts listados após <B>exclude_hosts</b> serão excluídos da verificação de serviço. <P><DT> <B>exclude_period</b> <I>periodpec</i> <DD> Não execute um monitor agendado durante o tempo identificado pelo período <I>especificado</i> . <P><DT> <B>depende</b> <I>dependexexpression</i> <DD> A palavra-chave <B>depend</b> é usada para especificar uma expressão de dependência, avaliada como verdadeira ou falsa, no sentido booleano. Dependências são expressões Perl reais e devem obedecer a todas as regras sintáticas. As expressões são avaliadas em seu próprio espaço de pacote para não ter acidentalmente algum efeito colateral indesejado. Se um erro de sintaxe for encontrado ao avaliar a expressão, ele será registrado via syslog. <P> Antes da avaliação, ocorrem as seguintes substituições na expressão: frases que se parecem com &quot;group: service&quot; são substituídas pelo valor do status operacional atual desse serviço especificado. Essas substituições de opstatus são computadas recursivamente; portanto, se o serviço A depende do serviço B e o serviço B depende do serviço C, o serviço A depende do serviço C. Os status operacionais bem-sucedidos (que são avaliados como &quot;1&quot;) são &quot;STAT_OK&quot;, &quot;STAT_COLDSTART &quot;,&quot; STAT_WARMSTART &quot;e&quot; STAT_UNKNOWN &quot;. A palavra &quot;SELF&quot; (em todas as maiúsculas) pode ser usada para o grupo (por exemplo, &quot;SELF: service&quot;) e é uma abreviação do atual grupo de observação. <P> Esse recurso pode ser usado para controlar alertas para serviços que dependem de outros serviços, por exemplo, um teste SMTP que depende da máquina ser alcançável por ping. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> A avaliação de gráficos de dependência pode controlar a supressão de chamadas de alerta ou monitor. <P> <B>Supressão de alerta</b> . Se esta opção estiver configurada como &quot;a&quot;, a expressão de dependência será avaliada após a saída do monitor para o serviço ou após o recebimento de uma interceptação. Um alerta será enviado apenas se a avaliação for bem-sucedida, o que significa que nenhum dos nós no gráfico de dependência indica falha. <P> <B>Monitorar a supressão</b> . Se estiver definido como &quot;m&quot;, a expressão de dependência será avaliada antes que o monitor do serviço esteja prestes a ser executado. Se a avaliação for bem-sucedida, o monitor será executado. Caso contrário, o monitor não será executado e o status do serviço permanecerá o mesmo. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Definições de período </H3><P> Períodos são usados para definir as condições que devem permitir que alertas sejam entregues. <P><DL COMPACT><DT> <B>período</b> <I>[label:] periodpec</i> <DD> Um período agrupa um ou mais alarmes e variáveis que controlam a frequência com que um alerta ocorre quando há uma falha. A palavra-chave <B>period</b> possui duas formas. O primeiro utiliza um argumento que é uma especificação de período do módulo Time :: Period Perl 5 de Patrick Ryan. Consulte &quot;Perldoc Time :: Period&quot; para obter mais informações. <P> O segundo formulário requer um rótulo seguido de uma especificação de período, conforme definido acima. O rótulo é uma tag que consiste em um caractere ou sublinhado alfabético seguido por zero ou mais caracteres alfanuméricos ou sublinhados e termina com dois pontos. Este formulário permite vários períodos com a mesma definição de período. Um uso é ter uma definição de período que não tenha nenhum <B>alerta</b> ou <B>alerta</b> para todos os parâmetros de um determinado período e outro para o mesmo período de tempo com um conjunto diferente de alertas que contenha esses parâmetros. <P><DT> <B>alertevery</b> <I>timeval</i> <DD> A palavra-chave <B>alertevery</b> (dentro de uma definição de <B>período</b> ) usa o mesmo tipo de argumento que a variável de <B>intervalo</b> e limita o número de vezes que um alerta é enviado quando o serviço continua a falhar. Por exemplo, se o intervalo for &quot;1h&quot;, apenas os alertas na seção de período serão acionados apenas uma vez a cada hora. Se a palavra-chave <B>alertevery</b> for omitida em uma entrada de período, um alerta será enviado sempre que uma falha for detectada. Por padrão, se a saída de duas falhas sucessivas mudar, o alerta a cada intervalo será substituído. Se a palavra &quot;resumo&quot; for o último argumento, apenas as linhas de saída do resumo serão consideradas ao comparar a saída de falhas sucessivas. <P><DT> <B>alertafter</b> <I>num</i> <DD><P><DT> <B>alertafter</b> <I>num timeval</i> <DD> A palavra-chave <B>alertafter</b> (dentro de uma seção de <B>período</b> ) tem duas formas: somente com o argumento &quot;num&quot; ou com os argumentos &quot;num timeval&quot;. Na primeira forma, um alerta será chamado somente após &quot;num&quot; falhas consecutivas. <P> Na segunda forma, os argumentos são um número inteiro positivo seguido por um intervalo, conforme descrito pela variável de <B>intervalo</b> acima. Se esses parâmetros forem especificados, os alertas para esse período serão chamados somente depois que muitas falhas ocorrerem dentro desse intervalo. Por exemplo, se o <B>alertafter</b> receber os argumentos &quot;3 30m&quot;, o alerta será chamado se 3 falhas ocorrerem dentro de 30 minutos. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Essa variável diz ao servidor para chamar não mais do que alertas <I>numéricos</i> durante uma falha. O contador de alertas é mantido por período e é redefinido a cada sucesso. <P><DT> <B>comp_alerts</b> <DD><P> Se essa opção for especificada, os upalerts serão chamados apenas se um alerta &quot;inativo&quot; correspondente tiver sido chamado. <P><DT> <B>alerta</b> <I>alerta [arg ...]</i> <DD> Um período pode conter vários alertas, que são acionados após falha do serviço. Um alerta é especificado com a palavra-chave <B>alert</b> , seguida por um parâmetro opcional de <B>saída</b> e argumentos que são interpretados da mesma forma que a definição do <B>monitor</b> , mas sem o &quot;;;&quot; exceção. O parâmetro <B>exit</b> assume a forma de <B>exit = x</b> ou <B>exit = xy</b> e tem o efeito de que o alerta será chamado apenas se o status de saída do script do monitor estiver dentro do intervalo do parâmetro de <B>saída</b> . Se, por exemplo, a linha de alerta for <I>exit de alerta = 10-20 mail.alert mis</i> , o <I>email mail alert</i> será invocado com <I>mis</i> como argumento se o valor de saída do programa de monitor estiver entre 10 e 20. Esse recurso permite disparar alertas diferentes em diferentes níveis de gravidade (como quando o espaço livre em disco passa de 8% a 3%). <P> Consulte a seção <B>ALERT PROGRAMS</b> acima para obter uma lista dos pramaeters que o mon passará automaticamente para alertar programas. <P><DT> <I>alerta</i> <B>upalert</b> <I>[arg ...]</i> <DD> Um <B>alerta ascendente</b> é o elogio de um <B>alerta</b> . Um alerta ascendente é chamado quando um serviço faz a transição do estado do fracasso para o sucesso. O script <B>upalert</b> é chamado de fornecimento dos mesmos parâmetros que o script de <B>alerta</b> , com a adição do parâmetro <B>-u,</b> que é simplesmente usado para permitir que um script de alerta saiba que está sendo chamado como upalert. Vários upalerts podem ser especificados para cada definição de período. Observe que o comportamento padrão é que um alerta ascendente seja enviado independentemente de haver alertas anteriores &quot;inativos&quot; enviados, pois os alertas ascendentes são acionados em uma transição de estado. Defina a opção <B>comp_alerts</b> por período para emparelhar upalerts com alertas &quot;inativos&quot;. <P><DT> <I>alerta de</i> <B>inicialização</b> <I>[arg ...]</i> <DD> Um <B>alerta de inicialização</b> é chamado apenas quando o servidor <B>mon</b> inicia a execução. <P><DT> <B>upalertafter</b> <I>timeval</i> <DD> O parâmetro <B>upalertafter</b> é especificado como uma sequência que segue a sintaxe do parâmetro <B>interval</b> (&quot;30s&quot;, &quot;1m&quot; etc.) e controla o acionamento de um <B>alerta upal</b> . Se um serviço voltar depois de ficar inativo por um tempo maior ou igual ao valor dessa opção, um <B>alerta de aumento</b> será chamado. Use esta opção para impedir que alertas de alerta sejam chamados devido a &quot;blips&quot; (breves interrupções). <P>