<header> ความช่วยเหลือ MON เกี่ยวกับคำจำกัดความบริการ </header><p> นี่เป็นขั้นตอนที่สองและสุดท้ายสำหรับการกำหนดค่า MON <p> ค่าเริ่มต้นจะปรากฏขึ้นสำหรับบริการที่บังคับ <marked in RED color> . ดูหัวข้อวิธีใช้ที่เกี่ยวข้องด้านล่างเพื่อรับความช่วยเหลือเพิ่มเติมเกี่ยวกับข้อกำหนดบริการ <p> สำหรับ <b>&quot;mail.alert&quot;</b> ตรวจสอบให้แน่ใจว่า sendmail ได้รับการกำหนดค่าและ <b>&quot;sendmail&quot;</b> deamon เริ่มทำงานบน hostmachine <H3> คำจำกัดความบริการ </H3><P><DL COMPACT><DT> <I>servicename</i> <B>บริการ</b> <DD> คำจำกัดความของบริการเริ่มต้นด้วยคำสำคัญที่ <B>ให้บริการ</b> ตามด้วยคำที่เป็นแท็กสำหรับบริการนี้ <P> ส่วนประกอบของบริการคือช่วงเวลาจอภาพและคำจำกัดความช่วงเวลาอย่างน้อยหนึ่งคำนิยามดังต่อไปนี้ <P> หากมีการกำหนดชื่อบริการของ &quot;ค่าเริ่มต้น&quot; ภายในกลุ่มการเฝ้าดูที่เรียกว่า &quot;dafault&quot; (ดูด้านบน) การกำหนดค่าเริ่มต้น / ค่าเริ่มต้นจะใช้สำหรับการจัดการกับดักจันทร์ที่ไม่รู้จัก <P><DT> <B>ช่วง</b> <I>timeval</i> <DD> <B>ช่วงเวลาของ</b> คำหลักตามด้วยค่าเวลาระบุความถี่ที่สคริปต์การตรวจสอบจะถูกเรียกใช้ ค่าเวลาถูกกำหนดเป็น &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot; หรือ &quot;1d&quot;, หมายถึง 30 วินาที, 5 นาที, 1 ชั่วโมงหรือ 1 วัน ส่วนที่เป็นตัวเลขอาจเป็นเศษส่วนเช่น &quot;1.5h&quot; หรือหนึ่งชั่วโมงครึ่ง รูปแบบของการกำหนดเวลานี้จะถูกเรียกว่า <I>timeval</i> <P><DT> <B>traptimeout</b> <I>timeval</i> <DD> <B><I>คำหลักนี้ต้องใช้เวลาเดียวกันอาร์กิวเมนต์สเปคเป็นช่วงเวลาและทำให้การบริการคาดหวังกับดักจากแหล่งภายนอกอย่างน้อยที่มักจะล้มเหลวอื่นจะถูกลงทะเบียน</i></b> สิ่งนี้ใช้สำหรับการบริการแบบ heartbeat <P><DT> <B>trapduration</b> <I>timeval</i> <DD> หากได้รับกับดักสถานะของบริการที่ส่งไปยังกับดักโดยปกติจะคงที่ หาก <B>trapduration</b> มีการระบุสถานะของบริการจะยังคงอยู่ในสถานะที่ล้มเหลวในช่วงระยะเวลาที่ระบุโดย <I>timeval</i> และจากนั้นมันจะถูกรีเซ็ตเป็น &quot;ความสำเร็จ&quot; <P><DT> <I>timeval</i> <B>randskew</b> <DD> แทนที่จะกำหนดเวลาสคริปต์การตรวจสอบเพื่อให้ทำงานในช่วงเริ่มต้นของแต่ละช่วงเวลาให้ปรับช่วงเวลาที่ระบุโดยพารามิเตอร์ <B>ช่วงเวลา</b> โดยการสุ่มบวกหรือลบ <B>randskew</b> ค่า skew ถูกระบุเป็นพารามิเตอร์ <B>ช่วงเวลา</b> : &quot;30s&quot;, &quot;5m&quot;, ฯลฯ ... ตัวอย่างเช่นถ้า <B>ช่วงเวลา</b> เป็น 1m และ <B>randskew</b> คือ &quot;5s&quot; จากนั้น <I>จันทร์</i> จะกำหนดเวลาสคริปต์การตรวจสอบทุก ๆ 55 วินาทีและ 65 วินาที จุดประสงค์คือช่วยกระจายโหลดบนเซิร์ฟเวอร์เมื่อมีการกำหนดบริการหลายอย่างในช่วงเวลาเดียวกัน <P><DT> <B>monitor</b> <I>monitor-name [หาเรื่อง ... ]</i> <DD> การ <B>ตรวจสอบ</b> คำหลักที่ตามด้วยชื่อสคริปต์และข้อโต้แย้งระบุจอภาพที่จะทำงานเมื่อจับเวลาหมดอายุ ข้อตกลงการอ้างข้อความเหมือนเชลล์จะถูกติดตามเมื่อระบุอาร์กิวเมนต์ที่ส่งไปยังสคริปต์การตรวจสอบ สคริปต์ถูกเรียกใช้จากไดเร็กทอรีที่กำหนดด้วยอาร์กิวเมนต์ <B>-s</b> และคำต่อไปนี้ทั้งหมดจะถูกส่งเป็นอาร์กิวเมนต์ของโปรแกรมตรวจสอบตามด้วยรายการโฮสต์ในกลุ่มที่อ้างอิงโดยกลุ่มการเฝ้าดูปัจจุบัน ถ้าจอภาพสิ้นสุดลงด้วย &quot;;;&quot; เป็นคำแยกกลุ่มโฮสต์จะไม่ได้ผนวกเข้ากับรายการอาร์กิวเมนต์เมื่อมีการเรียกใช้โปรแกรม <P><DT> <B>allow_empty_group</b> <DD> ตัวเลือก <B>allow_empty_group</b> จะอนุญาตให้มีการเรียกใช้จอภาพแม้ในขณะที่กลุ่มโฮสต์สำหรับการเฝ้าดูนั้นว่างเปล่าเนื่องจากโฮสต์ที่ถูกปิดใช้งาน พฤติกรรมเริ่มต้นจะไม่เรียกใช้จอภาพเมื่อโฮสต์ทั้งหมดในกลุ่มโฮสต์ถูกปิดใช้งาน <P><DT> <B>คำ</b> <I>อธิบาย</i> <DD> <B>คำอธิบาย</b> ข้อความต่อไปนี้ถูกสอบถามโดยโปรแกรมไคลเอนต์ส่งผ่านไปยังการแจ้งเตือนและตรวจสอบผ่านตัวแปรสภาพแวดล้อม ควรมีคำอธิบายสั้น ๆ ของบริการเหมาะสำหรับการรวมไว้ในอีเมลหรือบนเว็บเพจ <P><DT> <B>lude_hosts</b> <I>host [host ... ]</i> <DD> โฮสต์ใด ๆ ที่อยู่ในรายการหลัง <B>excluse_hosts</b> จะถูกแยกออกจากการตรวจสอบบริการ <P><DT> <B>ไม่รวมช่วง</b> <I>เวลาพิเศษ</i> <DD> อย่าเรียกใช้จอภาพที่มีกำหนดการในช่วงเวลาที่ระบุโดย <I>periodspec</i> <P><DT> <B>ขึ้นอยู่กับ</b> <I>แสดงออก</i> <DD> คีย์เวิร์ดการ <B>พึ่งพา</b> ถูกใช้เพื่อระบุนิพจน์การพึ่งพาซึ่งประเมินว่าเป็นจริงของเท็จในความหมายบูลีน การอ้างอิงเป็นนิพจน์ Perl จริงและต้องปฏิบัติตามกฎการสร้างประโยคทั้งหมด นิพจน์จะถูกประเมินในพื้นที่แพ็กเกจของตนเองเพื่อไม่ให้เกิดผลข้างเคียงที่ไม่พึงประสงค์ หากพบข้อผิดพลาดทางไวยากรณ์เมื่อประเมินผลนิพจน์นั้นจะถูกบันทึกผ่าน syslog <P> ก่อนการประเมินผลการแทนที่ในการแสดงออกต่อไปนี้เกิดขึ้น: วลีที่มีลักษณะเหมือน &quot;กลุ่ม: บริการ&quot; จะถูกแทนที่ด้วยค่าสถานะการทำงานปัจจุบันของบริการที่ระบุนั้น การทดแทน opstatus เหล่านี้จะถูกคำนวณซ้ำดังนั้นหากบริการ A ขึ้นอยู่กับบริการ B และบริการ B ขึ้นอยู่กับบริการ C ดังนั้นบริการ A ขึ้นอยู่กับบริการ C. สถานะการดำเนินงานที่ประสบความสำเร็จ (ซึ่งประเมินเป็น &quot;1&quot;) คือ &quot;STAT_OK&quot;, &quot;STAT_COLDSTART &quot;,&quot; STAT_WARMSTART &quot;และ&quot; STAT_UNKNOWN &quot; คำว่า &quot;SELF&quot; (ในตัวพิมพ์ใหญ่ทั้งหมด) สามารถใช้สำหรับกลุ่ม (เช่น &quot;SELF: service&quot;) และเป็นตัวย่อสำหรับกลุ่มนาฬิกาปัจจุบัน <P> คุณลักษณะนี้สามารถใช้เพื่อควบคุมการแจ้งเตือนสำหรับบริการที่ขึ้นอยู่กับบริการอื่น ๆ เช่นการทดสอบ SMTP ซึ่งขึ้นอยู่กับเครื่องที่สามารถเข้าถึงการ ping ได้ <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> การประเมินกราฟอ้างอิงสามารถควบคุมการปราบปรามของการแจ้งเตือนหรือตรวจสอบการร้องขอ <P> <B>การแจ้งเตือนการปราบปราม</b> หากตัวเลือกนี้ถูกตั้งค่าเป็น &quot;a&quot; การแสดงออกของการพึ่งพาจะถูกประเมินหลังจากที่จอภาพสำหรับบริการออกหรือหลังจากที่ได้รับกับดัก การแจ้งเตือนจะถูกส่งเมื่อการประเมินผลสำเร็จหมายความว่าไม่มีโหนดใดในกราฟที่ขึ้นต่อกันบ่งบอกถึงความล้มเหลว <P> <B>การตรวจสอบการปราบปราม</b> ถ้ามันถูกตั้งค่าเป็น &quot;m&quot; ดังนั้นนิพจน์การพึ่งพาจะหายไปก่อนที่จอภาพสำหรับบริการจะทำงาน หากการ evaulation สำเร็จแสดงว่าจอภาพจะทำงาน มิฉะนั้นจอภาพจะไม่ทำงานและสถานะของบริการจะยังคงเหมือนเดิม <P></DL><A NAME="lbAO">&nbsp;</A><H3> นิยามระยะเวลา </H3><P> ช่วงเวลาใช้เพื่อกำหนดเงื่อนไขที่ควรอนุญาตให้ส่งการแจ้งเตือน <P><DL COMPACT><DT> <B>period</b> <I>[label:] periodspec</i> <DD> ช่วงเวลาจะจัดกลุ่มการแจ้งเตือนและตัวแปรหนึ่งรายการขึ้นไปซึ่งควบคุมความถี่ที่จะเกิดการแจ้งเตือนเมื่อเกิดความล้มเหลว คำหลัก <B>ระยะเวลา</b> มีสองรูปแบบ ครั้งแรกที่จะโต้แย้งซึ่งเป็นข้อกำหนดระยะเวลาจากแพทริค Ryan&#39;s Time :: Period Perl 5 โมดูล อ้างถึง &quot;perldoc Time :: Period&quot; สำหรับข้อมูลเพิ่มเติม <P> แบบฟอร์มที่สองต้องใช้เลเบลตามด้วยข้อกำหนดระยะเวลาตามที่กำหนดไว้ด้านบน เลเบลคือแท็กที่ประกอบด้วยอักขระตัวอักษรหรือขีดล่างตามด้วยศูนย์หรือตัวอักษรและขีดล่างหรือเครื่องหมายขีดล่างและลงท้ายด้วยโคลอน แบบฟอร์มนี้อนุญาตให้มีหลายช่วงเวลาที่มีการกำหนดช่วงเวลาเดียวกัน หนึ่งใช้คือการมีความหมายระยะเวลาซึ่งไม่มี <B>alertafter</b> หรือพารามิเตอร์ <B>alertevery</b> สำหรับช่วงเวลาหนึ่งและอีกส่วนหนึ่งสำหรับช่วงเวลาเดียวกันกับชุดที่แตกต่างกันของการแจ้งเตือนว่าจะมีพารามิเตอร์เหล่านั้น <P><DT> <B>alertevery</b> <I>timeval</i> <DD> คำหลัก <B>alertevery</b> (ภายในนิยามของ <B>รอบระยะเวลา</b> ) ใช้อาร์กิวเมนต์ชนิดเดียวกันกับตัวแปร <B>ช่วงเวลา</b> และ จำกัด จำนวนครั้งที่การแจ้งเตือนจะถูกส่งเมื่อบริการยังคงล้มเหลว ตัวอย่างเช่นหากช่วงเวลาเป็น &quot;1 ชั่วโมง&quot; ดังนั้นเฉพาะการแจ้งเตือนในส่วนระยะเวลาจะถูกเรียกใช้เพียงครั้งเดียวทุก ๆ ชั่วโมง หากไม่ใช้คำหลัก <B>Alertevery</b> ในรายการช่วงเวลาการแจ้งเตือนจะถูกส่งออกทุกครั้งที่ตรวจพบความล้มเหลว ตามค่าดีฟอลต์หากเอาต์พุตของความล้มเหลวต่อเนื่องสองครั้งมีการเปลี่ยนแปลงช่วงเวลาการแจ้งเตือนจะถูกแทนที่ หากคำว่า &quot;สรุป&quot; เป็นอาร์กิวเมนต์สุดท้ายดังนั้นเฉพาะบรรทัดเอาต์พุตสรุปเท่านั้นที่จะถูกพิจารณาเมื่อเปรียบเทียบเอาต์พุตของความล้มเหลวต่อเนื่อง <P><DT> <B>การแจ้งเตือนหลังจาก</b> <I>NUM</i> <DD><P><DT> <B>alertafter</b> <I>NUM timeval</i> <DD> คำหลัก <B>alert ภายหลัง</b> (ภายในส่วนของ <B>รอบระยะเวลา</b> ) มีสองรูปแบบ: เฉพาะกับอาร์กิวเมนต์ &quot;num&quot; หรือด้วยอาร์กิวเมนต์ &quot;num timeval&quot; ในรูปแบบแรกการแจ้งเตือนจะถูกเรียกใช้หลังจากความล้มเหลวติดต่อกันเป็น &quot;NUM&quot; เท่านั้น <P> ในรูปแบบที่สองข้อโต้แย้งเป็นจำนวนเต็มบวกตามด้วยช่วงเวลาตามที่อธิบายโดยตัวแปร <B>ช่วงเวลา</b> ด้านบน หากระบุพารามิเตอร์เหล่านี้การแจ้งเตือนสำหรับช่วงเวลานั้นจะถูกเรียกหลังจากความล้มเหลวจำนวนมากเกิดขึ้นภายในช่วงเวลานั้นเท่านั้น ตัวอย่างเช่นถ้า <B>alertafter</b> จะได้รับข้อโต้แย้ง &quot;3 30m&quot; จากนั้นการแจ้งเตือนจะถูกเรียกว่าถ้า 3 ความล้มเหลวที่เกิดขึ้นภายใน 30 นาที <P><DT> <B>ตัวเลข</b> <I>NUM</i> <DD><P> ตัวแปรนี้จะบอกเซิร์ฟเวอร์ที่จะเรียกไม่เกินแจ้งเตือน <I>NUM</i> ระหว่างความล้มเหลว ตัวนับการแจ้งเตือนจะถูกเก็บไว้เป็นระยะ ๆ และจะถูกรีเซ็ตตามความสำเร็จแต่ละครั้ง <P><DT> <B>comp_alerts</b> <DD><P> หากระบุตัวเลือกนี้จะมีการเรียกใช้ upalerts เฉพาะเมื่อมีการเรียกการแจ้งเตือน &quot;down&quot; ที่เกี่ยวข้อง <P><DT> <B>การแจ้งเตือนการแจ้ง</b> <I>เตือน [หาเรื่อง ... ]</i> <DD> ช่วงเวลาอาจมีการแจ้งเตือนหลายครั้งซึ่งจะถูกเรียกใช้เมื่อความล้มเหลวของการบริการ <B><B>การแจ้งเตือนจะถูกระบุด้วยคำเตือนตามด้วยการออก</b></b> parmeter <B>ตัวเลือกและข้อโต้แย้งที่มีการตีความเช่นเดียวกับความละเอียดของจอภาพ</b> แต่ไม่มี &quot;;;&quot; ข้อยกเว้น พารามิเตอร์ <B>exit</b> ใช้รูปแบบ <B>exit = x</b> หรือ <B>exit = xy</b> และมีผลกระทบที่การแจ้งเตือนจะถูกเรียกก็ต่อเมื่อสถานะการออกของสคริปต์การตรวจสอบอยู่ในช่วงของพารามิเตอร์ <B>ทางออก</b> ตัวอย่างเช่นหากบรรทัดการแจ้งเตือนคือการ <I>แจ้งเตือน exit = 10-20 mail.alert mis</i> <I>การแจ้งเตือนเมล</i> จะถูกเรียกใช้ด้วย <I>mis</i> เป็นอาร์กิวเมนต์เท่านั้นหากค่าการออกของโปรแกรมตรวจสอบอยู่ระหว่าง 10 ถึง 20 คุณลักษณะนี้ช่วยให้คุณสามารถทริกเกอร์ การแจ้งเตือนที่แตกต่างกันในระดับความรุนแรงที่แตกต่างกัน (เช่นเมื่อพื้นที่ว่างในดิสก์เพิ่มจาก 8% เป็น 3%) <P> ดูที่ส่วนของ <B>โปรแกรม ALERT</b> ด้านบนเพื่อดูรายการของ pramaeters จันทร์ที่จะผ่านโดยอัตโนมัติไปยังโปรแกรมการแจ้งเตือน <P><DT> <B>การ</b> <I>แจ้งเตือน</i> <B>upalert</b> <I>[หาเรื่อง ... ]</i> <DD> <B>upalert</b> คือคำชมเชยจากการ <B>แจ้งเตือน</b> upalert จะถูกเรียกเมื่อบริการทำให้การเปลี่ยนสถานะจากความล้มเหลวเป็นความสำเร็จ สคริปต์ <B>upalert</b> เรียกว่าการจัดหาพารามิเตอร์เดียวกันกับสคริปต์การ <B>แจ้งเตือน</b> ด้วยการเพิ่มพารามิเตอร์ <B>-u</b> ซึ่งใช้เพียงเพื่อให้สคริปต์การแจ้งเตือนทราบว่ามันถูกเรียกว่าเป็น upalert อาจมีการแสดงหลายรายการสำหรับแต่ละช่วงเวลา โปรดทราบว่าพฤติกรรมเริ่มต้นคือการ upalert จะถูกส่งโดยไม่คำนึงว่ามีการแจ้งเตือน &quot;down&quot; ใด ๆ ที่ส่งก่อนหน้านี้เนื่องจาก upalerts จะถูกทริกเกอร์ในการเปลี่ยนสถานะ ตั้งค่าตัวเลือก <B>comp_alerts</b> ต่องวดเพื่อจับคู่ upalerts กับการแจ้งเตือน &quot;down&quot; <P><DT> <B>การ</b> <I>แจ้งเตือนการเริ่มต้นระบบ [arg ... ]</i> <DD> <B>startupalert</b> ถูกเรียกใช้เฉพาะเมื่อเซิร์ฟเวอร์ <B>mon</b> เริ่มการทำงาน <P><DT> <B>upalertafter</b> <I>timeval</i> <DD> พารามิเตอร์ <B>upalertafter</b> ถูกระบุเป็นสตริงที่ตามด้วยไวยากรณ์ของพารามิเตอร์ <B>ช่วงเวลา</b> (&quot;30s&quot;, &quot;1m&quot; ฯลฯ ) และควบคุมการทริกเกอร์ของ <B>upalert</b> หากบริการเกิดขึ้นหลังจากหยุดทำงานนานกว่าหรือเท่ากับมูลค่าของตัวเลือกนี้จะมีการเรียกใช้ <B>upalert</b> ใช้ตัวเลือกนี้เพื่อป้องกันไม่ให้มีการเรียกใช้ upalerts เนื่องจาก &quot;blips&quot; (ขัดข้องสั้น ๆ ) <P>