<header> MON pagalba teikiant paslaugų apibrėžimus </header><p> Tai yra antrasis ir paskutinis MON konfigūravimo etapas. <p> Numatytosios vertės rodomos Privalomoms paslaugoms <marked in RED color> . Norėdami gauti daugiau pagalbos apie paslaugų apibrėžimus, žiūrėkite atitinkamą pagalbos temą žemiau. <p> <b>„Mail.alert“</b> įsitikinkite, kad sukonfigūruotas <b>„sendmail“</b> ir pagrindiniame mašinoje paleistas <b>„sendmail“</b> deamonas. <H3> Paslaugos apibrėžimai </H3><P><DL COMPACT><DT> <B>serviso</b> <I>vardas</i> <DD> Paslaugos apibrėžimas prasideda žodžių <B>paslauga,</b> po kurios eina žodis, kuris yra šios paslaugos žymė. <P> Paslaugos komponentai yra intervalas, monitorius ir vienas ar keli laiko apibrėžimai, kaip apibrėžta toliau. <P> Jei stebėjimo grupėje, kuri vadinama „dafault“, apibrėžtas „numatytojo“ paslaugos pavadinimas (žr. Aukščiau), tada nežinomų monų spąstams tvarkyti bus naudojamas numatytasis / numatytasis apibrėžimas. <P><DT> <B>intervalas</b> <I>timeval</i> <DD> Raktinių žodžių <B>intervalas,</b> einantis po laiko vertės, nurodo dažnį, kurį suaktyvins monitoriaus scenarijus. Laiko vertės yra apibrėžtos kaip „30s“, „5m“, „1h“ arba „1d“, reiškiančios 30 sekundžių, 5 minutes, 1 valandą arba 1 dieną. Skaitinė dalis gali būti trupmena, tokia kaip „1,5h“ arba pusantros valandos. Šis laiko specifikacijos formatas bus vadinamas laiko <I>intervalu</i> . <P><DT> <B>traptimeout</b> <I>timeval</i> <DD> Šis raktinis žodis naudoja tą patį laiko specifikacijos argumentą kaip ir <B>intervalas</b> <I>,</i> todėl tarnyba bent kartą tikisi spąstų iš išorinio šaltinio, kitu atveju gedimas bus užregistruojamas. Tai naudojama atliekant širdies plakimo stiliaus paslaugas. <P><DT> <B>trapduration</b> <I>timeval</i> <DD> Jei gaudyklė bus gauta, paslaugos, kuriai gaudyklė buvo suteikta, būsena paprastai išliks pastovi. Jei <B>nurodomas trapduration</b> , paslaugos būsena liks gedimo būsenoje nurodytą <I>laiką</i> , tada ji bus atkurta į „sėkmę“. <P><DT> <B>randskew</b> <I>timeval</i> <DD> Užuot <B>planavę</b> monitoriaus scenarijų paleisti kiekvieno intervalo pradžioje, atsitiktine tvarka pakoreguokite <B>intervalo</b> parametru nurodytą <B>intervalą</b> pliuso ar minuso <B>randskew pagalba.</b> Nerijos vertė yra nurodyta kaip <B>intervalo</b> parametras &quot;30s&quot;, &quot;5m&quot;, ir kt ... Pavyzdžiui, jei <B>intervalas</b> yra 1m ir <B>randskew</b> yra &quot;5S&quot;, tada <I>pirmadienis</i> bus suplanuoti monitoriaus scenarijų kai tarp kas 55 sekundžių ir laikas 65 sekundės. Tikslas yra padėti paskirstyti serverio apkrovą, kai daugelis paslaugų yra suplanuotos tuo pačiu intervalu. <P><DT> <B>monitoriaus</b> <I>monitoriaus vardas [arg ...]</i> <DD> Raktinis žodis <B>monitorius,</b> po kurio pateikiamas scenarijaus pavadinimas ir argumentai, nurodo, kad monitorius turėtų veikti pasibaigus laikmačiui. Nurodant argumentus, kuriuos reikia nusiųsti monitoriaus scenarijui, laikomasi į apvalkalą panašios citavimo tvarkos. Scenarijus iškviečiamas iš katalogo, pateikto kartu su argumentu <B>-s</b> , ir visi šie žodžiai pateikiami kaip argumentai monitoriaus programai, o po to pateikiamas grupės prieglobos sąrašas, kurį nurodo dabartinė stebėjimo grupė. Jei monitoriaus eilutė baigiasi raide &quot;;;&quot; kaip atskiras žodis, priimančiosios grupės nėra pridedamos prie argumentų sąrašo, kai yra iškviečiama programa. <P><DT> <B>leisti_empty_group</b> <DD> <B>Parinktis leisti_empty_group</b> leis monitorių iškviesti net tada, kai to laikrodžio pagrindinė grupė yra tuščia dėl neįgalių kompiuterių. Numatytasis elgesys yra nesuaktyvinti monitoriaus, kai visi pagrindinio kompiuterio grupės kompiuteriai yra išjungti. <P><DT> <B>aprašymo</b> <I>aprašymo tekstas</i> <DD> Toliau pateiktame <B>apraše</b> pateikiamos užklausos iš klientų programų, perduodamos perspėjimams ir monitoriams per aplinkos kintamąjį. Jame turėtų būti trumpas paslaugos aprašymas, tinkamas įtraukti į el. Laišką ar tinklalapį. <P><DT> <B>neįtraukti vaizdų</b> <I>priegloba [priegloba ...]</i> <DD> Visi kompiuteriai, išvardyti po „ <B>išskirti_vaizdius“,</b> nebus įtraukiami į paslaugų patikrinimą. <P><DT> <B>neįtraukti</b> <I>periodų laikotarpių</i> <DD> Nenaudokite suplanuoto monitoriaus tuo laikotarpiu, kurį nustato <I>periodpec</i> . <P><DT> <B>priklauso nuo</b> <I>dependekspression</i> <DD> <B>Priklauso</b> raktažodis naudojamas nurodyti priklausomybės išraiška, kuri vertina, kad nors tiesa klaidinga, į boolean prasme. Priklausomybės yra realios „Perl“ išraiškos ir jos turi atitikti visas sintaksines taisykles. Išraiškos vertinamos jų pačių pakuotės vietoje, kad netyčia nepadarytų nepageidaujamo šalutinio poveikio. Jei vertinant išraišką randama sintaksės klaida, ji registruojama per syslog. <P> Prieš vertinimą, šie posakiai pakeičiami taip: frazės, kurios atrodo kaip „grupė: tarnyba“, pakeičiamos tos nurodytos paslaugos dabartinės eksploatavimo būklės verte. Šie optinio stoties pakeitimai yra skaičiuojami rekursyviai, taigi, jei A paslauga priklauso nuo B paslaugos, o B paslauga priklauso nuo C paslaugos, tada A paslauga priklauso nuo C paslaugos. Sėkmingos eksploatavimo būsenos (kurios vertinamos kaip „1“) yra „STAT_OK“, „STAT_COLDSTART“. “,„ STAT_WARMSTART “ir„ STAT_UNKNOWN “. Žodis „SELF“ (visomis didžiosiomis raidėmis) gali būti naudojamas grupei (pvz., „SELF: service“) ir yra dabartinės stebėjimo grupės santrumpa. <P> Ši funkcija gali būti naudojama norint kontroliuoti perspėjimus apie paslaugas, kurios priklauso nuo kitų paslaugų, pvz., SMTP testą, kuris priklauso nuo to, ar mašina gali pasiekti pingą. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> Priklausomybės grafikų įvertinimas gali kontroliuoti perspėjimo arba monitoriaus iškvietimų slopinimą. <P> <B>Įspėjimo slopinimas</b> . Jei ši parinktis nustatyta kaip „a“, priklausomybės išraiška bus įvertinta tada, kai paslaugų monitorius išeis arba gautas spąstus. Įspėjimas bus išsiųstas tik tuo atveju, jei įvertinimas bus sėkmingas, tai reiškia, kad nė vienas priklausomybės diagramos mazgas nenurodo gedimo. <P> <B>Monitoriaus slopinimas</b> . Jei jis nustatytas kaip „m“, tada priklausomybės išraiška bus išgarinta prieš pradedant veikti aptarnavimo monitoriui. Jei išgarinti pavyksta, monitorius bus paleistas. Priešingu atveju monitorius nebus paleistas, o paslaugos būsena išliks tokia pati. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Laikotarpio apibrėžimai </H3><P> Laikotarpiai naudojami apibrėžti sąlygas, kuriomis turėtų būti leidžiama perspėti. <P><DL COMPACT><DT> <B>periodas</b> <I>[etiketė:] periodai</i> <DD> Laikotarpis grupuoja vieną ar kelis aliarmus ir kintamuosius, kurie kontroliuoja, kaip dažnai perspėjimas įvyksta įvykus nesklandumui. <B>Laikotarpio</b> raktinis žodis yra dviejų formų. Pirmasis pateikia argumentą, kuris yra periodo specifikacija iš Patricko Ryano „Time: Period Perl 5“ modulio. Norėdami gauti daugiau informacijos, skaitykite „perldoc Time :: Period“. <P> Antra forma reikalauja etiketės, po kurios nurodomas laikotarpio apibrėžimas, kaip apibrėžta aukščiau. Etiketė yra etiketė, susidedanti iš abėcėlės raidės ar apatinių brūkšnių, po kurių eina nulis ar daugiau raidinių ar skaitmeninių raidžių ar pabraukimų, ir baigiasi dvitaškiu. Ši forma leidžia kelis laikotarpius su tuo pačiu laikotarpio apibrėžimu. Vienas iš jų yra periodo apibrėžimas, kuriame nėra jokių <B>perspėjimo</b> ar <B>įspėjimo</b> parametrų tam tikram laikotarpiui, o kitas - tam pačiam laikotarpiui su skirtingais perspėjimų rinkiniais, kuriuose yra šie parametrai. <P><DT> <B>skubios pagalbos</b> <I>laikas</i> <DD> <B>Perspėjimo apie</b> raktinį žodį raktinis žodis (apibrėžtame <B>laikotarpio</b> apibrėžime) naudoja to paties tipo argumentus kaip ir <B>intervalo</b> kintamasis ir riboja perspėjimo siuntimo kartų skaičių, kai paslauga ir toliau nesiseka. Pvz., Jei intervalas yra „1h“, tada tik perspėjimai laikotarpio skiltyje bus suaktyvinami tik kartą per valandą. Jei laikotarpio įraše praleistas <B>įspėjimo apie</b> raktinį žodį raktinis žodis, perspėjimas bus išsiųstas kiekvieną kartą aptikus gedimą. Pagal nutylėjimą, jei pasikeičia dviejų iš eilės gedimų išvestis, perspėjimo intervalas yra viršijamas. Jei žodis „santrauka“ yra paskutinis argumentas, lyginant iš eilės atsirandančių nesėkmių rezultatus bus atsižvelgiama tik į suvestinės išvesties eilutes. <P><DT> <B>alertafter</b> <I>num</i> <DD><P><DT> <B>po kiek</b> <I>laiko</i> <DD> „ <B>Alertafter“</b> raktinis žodis ( <B>laikotarpio</b> skiltyje) yra dviejų formų: tik su „num“ argumentu arba su „num timeval“ argumentais. Pirmoje formoje perspėjimas bus iškviestas tik po „num“ iš eilės įvykusių nesėkmių. <P> Antroje formoje argumentai yra teigiamas sveikasis skaičius, einantis intervalas, kaip aprašyta aukščiau pateiktame <B>intervalo</b> kintamajame. Jei šie parametrai yra nurodyti, tada laikotarpio perspėjimai bus iškviečiami tik po to, kai per tą laiką įvyks daug gedimų. Pvz., Jei <B>signalizatoriui</b> pateikiami argumentai „3 30m“, tada perspėjimas bus iškviestas, jei 3 nesėkmės įvyks per 30 minučių. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Šis kintamasis nurodo serveriui gedimo metu skambinti ne daugiau kaip <I>numerių</i> perspėjimais. Įspėjimo skaitiklis yra saugomas periodiškai ir yra nustatomas iš naujo kiekvienos sėkmės atveju. <P><DT> <B>comp_alerts</b> <DD><P> Jei ši parinktis yra nurodyta, tada „upalerts“ bus iškviečiamas tik tuo atveju, jei buvo iškviestas atitinkamas „žemyn“ perspėjimas. <P><DT> <B>perspėjimo</b> <I>perspėjimas [arg ...]</i> <DD> Laikotarpyje gali būti keli perspėjimai, kurie suveikia sugedus paslaugai. Įspėjimas nurodomas su <B>perspėjimo</b> žodžiu, po kurio pateikiamas pasirenkamas <B>išėjimo</b> parmetras, ir argumentai, kurie aiškinami taip, kaip <B>monitoriaus</b> apibrėžimas, bet be „;;“ išimtis. <B>Išėjimo</b> parametras yra <B>išėjimo = x</b> arba <B>išėjimo = xy</b> pavidalu ir įspėjamasis signalas iškviečiamas tik tuo atveju, jei monitoriaus scenarijaus išėjimo būsena patenka į <B>išėjimo</b> parametro diapazoną. Jei, pavyzdžiui, įspėjimas linija yra <I>perspėjimas išėjimo = 10-20 mail.alert MIS</i> tada <I>paštas įspėjimo</i> bus taikoma tik su <I>IVS,</i> kaip savo argumentus, jei monitoriaus programos išeiti vertė yra tarp 10 ir 20 Ši funkcija leidžia jums sukelti skirtingi įspėjimai skirtingo sunkumo lygiais (pvz., kai laisvos vietos diske užima nuo 8% iki 3%). <P> Žr. Aukščiau esantį <B>ALERT PROGRAMŲ</b> skyrių, kur pateikiami pramaterių, kurie automatiškai perspės apie perspėjimo programas, sąrašas. <P><DT> <B>upalert</b> <I>alert [arg ...]</i> <DD> <B>Upalertas</b> yra <B>įspėjimo</b> komplimentas. Upalertas vadinamas tada, kai dėl paslaugų valstybės pereina nuo nesėkmės prie sėkmės. <B>Upalert</b> scenarijus vadinamas tiekiančiu tuos pačius parametrus, kaip ir <B>perspėjimo</b> scenarijus, pridedant parametrą <B>-u,</b> kuris yra tiesiog naudojamas įspėjimo scenarijui pranešti, kad jis vadinamas upalert. Kiekvienam laikotarpio apibrėžimui gali būti nurodytos kelios upalertės. Atminkite, kad numatytasis elgesys yra tas, kad „upalert“ bus siunčiamas neatsižvelgiant į tai, ar nebuvo siunčiami jokie ankstesni perspėjimai „žemyn“, nes keičiant būseną, „upalert“ įjungiamos. Nustatykite už laikotarpį <B>comp_alerts</b> variantą suporuoti upalerts su &quot;žemyn&quot; perspėjimų. <P><DT> <B>startupalert</b> <I>alert [arg ...]</i> <DD> „ <B>Startupalert“ iškviečiamas</b> tik tada, kai <B>mon</b> serveris pradeda vykdyti. <P><DT> <B>pasibaigus</b> <I>laikui</i> <DD> „ <B>Upalertafter“</b> parametras nurodomas kaip eilutė, <B>einanti</b> po <B>intervalo</b> parametro sintaksės („30s“, „1m“ ir kt.) Ir kontroliuojanti „ <B>upalert“ suveikimą</b> . Jei paslauga vėl bus sukurta neveikiant didesnei ar lygiai šios parinkties <B>vertei,</b> bus iškviestas „ <B>Upalert</b> “. Naudokite šią parinktį, kad išvengtumėte vadinamųjų „upalerts“ dėl „mirksėjimo“ (trumpų nutraukimų). <P>