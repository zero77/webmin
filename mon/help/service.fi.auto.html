<header> MON-ohje palvelumääritelmistä </header><p> Tämä on toinen ja viimeinen vaihe MON-konfiguraatiossa. <p> Oletusarvot näytetään Pakollisille palveluille <marked in RED color> . Katso alla olevasta vastaavasta ohjeaiheesta lisätietoja palvelumääritelmistä. <p> Varmista <b>&quot;mail.alert&quot;: lle</b> , että sendmail on määritetty ja <b>&quot;sendmail&quot;</b> -deamoni on käynnistetty koneessa. <H3> Palvelun määritelmät </H3><P><DL COMPACT><DT> <B>palvelun</b> <I>palvelunimi</i> <DD> Palvelumääritys alkaa ne avainsanan <B>palvelu</b> seuraa sana, joka on tunnisteen tästä palvelusta. <P> Palvelun komponentit ovat aikaväli, näyttö ja yksi tai useampi ajanjaksomääritelmä, kuten jäljempänä määritellään. <P> Jos &quot;oletus&quot; -palvelun nimi on määritelty valvontaryhmässä nimeltä &quot;dafault&quot; (katso yllä), oletus- / oletusmäärittelyä käytetään tuntemattomien monien ansojen käsittelemiseen. <P><DT> <B>aikaväli</b> <I>aikaväli</i> <DD> Avainsanan <B>aikaväli</b> seuraa aika-arvo täsmennetään taajuus, että monitori skripti laukeaa. Aika-arvot on määritelty &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot; tai &quot;1d&quot;, mikä tarkoittaa 30 sekuntia, 5 minuuttia, 1 tunti tai 1 päivä. Numeerinen osa voi olla murto-osa, kuten &quot;1,5h&quot; tai puolitoista tuntia. Tätä aikamääritysmuotoa kutsutaan <I>aikavaliksi</i> . <P><DT> <B>traptimeout</b> <I>timeval</i> <DD> Tämä avainsana vie saman ajan määrittelyargumentin kuin <B>aikaväli</b> <I>,</i> ja saa palvelun odottamaan ansaan ulkoiselta lähteeltä ainakin niin usein, muuten vika rekisteröidään. Tätä käytetään syketyyliseen palveluun. <P><DT> <B>trapduration</b> <I>timeval</i> <DD> Jos ansa vastaanotetaan, sen palvelun tila, johon loukku toimitettiin, pysyy yleensä vakiona. Jos <B>trapduraatio</b> määritetään, palvelun tila pysyy vikatilassa ajanjakson määrittämän <I>ajan</i> , ja sitten se palautetaan &quot;menestykseen&quot;. <P><DT> <B>randskew</b> <I>timeval</i> <DD> Sen sijaan, että <B>näytönohjain</b> suoritettaisiin kunkin aikavälin alussa, säädä satunnaisesti intervalliparametrin määrittelemää <B>intervallia</b> plus tai miinus <B>randskew.</b> Vinoarvo määritetään <B>aikaväliparametrina</b> : &quot;30s&quot;, &quot;5m&quot; jne. ... Jos esimerkiksi <B>väli</b> on 1m ja <B>randskew</b> on &quot;5s&quot;, niin <I>mon</i> asettaa näytön komentosarjan jonkin ajanjakson välein 55 sekunnin välein ja 65 sekuntia. Tarkoitus on auttaa jakamaan palvelimen kuormitus, kun monet palvelut on ajoitettu samoin väliajoin. <P><DT> <B>monitorin</b> <I>näytön nimi [arg ...]</i> <DD> Hakusanalla <B>monitori</b> seuraa käsikirjoituksen nimi ja argumentit täsmennetään monitorin kulua siitä, kun aika on kulunut. Kuorimaisia lainauskäytäntöjä noudatetaan määriteltäessä monitorin komentosarjoille lähetettäviä argumentteja. Skripti kutsutaan hakemistosta, joka on annettu <B>-s-</b> argumentin kanssa, ja kaikki seuraavat sanat toimitetaan argumentteina monitoriohjelmalle, jota seuraa luettelo isäntäryhmästä ryhmässä, johon nykyinen tarkkailuryhmä viittaa. Jos monitorilinja päättyy &quot;;;&quot; erillisenä sanana isäntäryhmiä ei liitetä argumenttiluetteloon, kun ohjelmaa kutsutaan. <P><DT> <B>allow_empty_group</b> <DD> <B>Allow_empty_group</b> -vaihtoehto sallii näytön käynnistämisen myös silloin, kun kyseisen kellon isäntäryhmä on tyhjä käytöstä poistettujen isäntien takia. Oletuskäyttäytyminen ei ole monitorin kutsuminen, kun kaikki isäntäryhmän isännät on poistettu käytöstä. <P><DT> <B>kuvaus</b> <I>kuvausteksti</i> <DD> Seuraava <B>kuvaus</b> kuvataan asiakasohjelmien toimesta, se välitetään hälytyksille ja monitorille ympäristömuuttujan kautta. Sen tulisi sisältää lyhyt kuvaus palvelusta, joka soveltuu sisällytettäväksi sähköpostiin tai verkkosivulle. <P><DT> <B>poissuljettavat_hosts-</b> <I>isäntä</i> <DD> Kaikki <B>isäntät,</b> jotka on lueteltu <B>sulje_hosts</b> jälkeen, <B>jätetään huoltotarkastuksen</b> ulkopuolelle. <P><DT> <B>exclude_period</b> <I>periodspec</i> <DD> Älä aja ajoitettua näyttöä ajanjakson määrittämän ajan <I>kuluessa</i> . <P><DT> <B>riippuvat</b> <I>dependekspressiosta</i> <DD> <B>Depend</b> avainsanaa käytetään määrittää riippuvuus ilmaisu, joka evaluoi joko tosi vääriä, että boolean mielessä. Riippuvuudet ovat todellisia Perl-lausekkeita, ja niiden on noudatettava kaikkia syntaksisia sääntöjä. Lausekkeet arvioidaan omassa pakkaustilassaan, jotta vahingossa ei aiheutuisi ei-toivottuja sivuvaikutuksia. Jos syntaksivirhe löytyy lauseketta arvioitaessa, se kirjataan syslogin kautta. <P> Ennen arviointia lausekkeessa tapahtuu seuraavia korvauksia: lauseet, jotka näyttävät &quot;ryhmältä: palvelulta&quot;, korvataan kyseisen määritellyn palvelun nykyisen toimintatilan arvolla. Nämä opstatus-substituutiot lasketaan rekursiivisesti, joten jos palvelu A riippuu palvelusta B ja palvelu B riippuu palvelusta C, niin palvelu A riippuu palvelusta C. Onnistuneet toimintatilat (jotka arvioivat arvoksi &quot;1&quot;) ovat &quot;STAT_OK&quot;, &quot;STAT_COLDSTART &quot;,&quot; STAT_WARMSTART &quot;ja&quot; STAT_UNKNOWN &quot;. Sanaa &quot;SELF&quot; (kaikissa kirjaimissa) voidaan käyttää ryhmässä (esim. &quot;SELF: palvelu&quot;), ja se on lyhenne nykyiselle katseluryhmälle. <P> Tätä ominaisuutta voidaan käyttää muista palveluista riippuvien palveluiden hälytysten ohjaamiseen, esimerkiksi SMTP-testi, joka riippuu koneen ping-tavoitettavuudesta. <P><DT> <B>dep_hehavior</b> <I>{a | m}</i> <DD> Riippuvuuskaavioiden arviointi voi hallita joko hälytysten tai monitorien kutsujen tukahduttamista. <P> <B>Hälytysten tukahduttaminen</b> . Jos tämä vaihtoehto on asetettu &quot;a&quot;, riippuvuuslauseke arvioidaan palvelun näytön poistumisen tai loukun vastaanottamisen jälkeen. Hälytys lähetetään vain, jos arviointi onnistuu, mikä tarkoittaa, että yksikään riippuvuusgraafin solmuista ei ilmaise virhettä. <P> <B>Monitorin tukahduttaminen</b> . Jos se on asetettu arvoon &quot;m&quot;, riippuvuuslauseke haihtuu ennen palvelun näytön alkamista. Jos höyrystyminen onnistuu, näyttöä käytetään. Muutoin näyttöä ei käytetä ja palvelun tila pysyy samana. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Kauden määritelmät </H3><P> Jaksoja käytetään määrittelemään ehdot, joiden avulla hälytykset voidaan toimittaa. <P><DL COMPACT><DT> <B>period</b> <I>[tarra:] periodpec</i> <DD> Jakso ryhmittelee yhden tai useamman hälytyksen ja muuttujan, jotka ohjaavat kuinka usein hälytys tapahtuu, kun vika tapahtuu. <B>Jakson</b> avainsanalla on kaksi muotoa. Ensimmäisessä otetaan argumentti, joka on ajanjaksomäärittely Patrick Ryanin Time :: Period Perl 5 -moduulista. Katso &quot;perldoc Time :: Period&quot; saadaksesi lisätietoja. <P> Toinen muoto vaatii etiketin, jota seuraa jakson määritelmä, kuten edellä on määritelty. Tarra on merkki, joka koostuu aakkosellisesta merkistä tai alaviivoista, joita seuraa nolla tai enemmän aakkosnumeerisia tai alaviivaisia ja päättyy kaksoispisteellä. Tämä muoto sallii useita jaksoja samalla jaksolla. Yksi käyttö on saada aikaan <B>jaksomääritys,</b> jolla ei ole <B>hälytysparametrit</b> tai <B>hälytysparametrit</b> tietylle ajanjaksolle, ja toinen käyttö samalle ajanjaksolle eri hälytysjoukolla, joka sisältää nämä parametrit. <P><DT> <B>alertevery</b> <I>timeval</i> <DD> <B>Alertevery-</b> avainsana ( <B>ajanjakson</b> määritelmässä) ottaa samantyyppisiä argumentteja kuin <B>aikavälimuuttuja</b> ja rajoittaa hälytyskertojen määrää, kun palvelu jatkaa epäonnistumista. Esimerkiksi, jos aikaväli on &quot;1h&quot;, vain ajanjakson hälytykset laukaistaan vain kerran tunnissa. Jos <B>hälytysten</b> avainsana jätetään pois ajanjakson merkinnästä, hälytys lähetetään aina, kun vika havaitaan. Oletuksena, jos kahden peräkkäisen vian tulos muuttuu, hälytysväli ohitetaan. Jos sana &quot;yhteenveto&quot; on viimeinen argumentti, niin vain yhteenvedon tulorivit otetaan huomioon vertaamalla peräkkäisten virheiden tuloksia. <P><DT> <B>alertafter</b> <I>numero</i> <DD><P><DT> <B>alertafter</b> <I>num timeval</i> <DD> <B>Alertatern-</b> avainsanalla ( <B>ajanjakson</b> sisällä) on kaksi muotoa: vain &quot;num&quot; -argumentin tai &quot;num timeval&quot; -argumentin kanssa. Ensimmäisessä muodossa hälytys otetaan käyttöön vasta peräkkäisten &quot;num&quot; -vikojen jälkeen. <P> Toisessa muodossa argumentit ovat positiivinen kokonaisluku, jota seuraa intervalli, kuten yllä kuvattu <B>aikavälimuuttuja</b> kuvaa. Jos nämä parametrit määritetään, kyseisen ajanjakson hälytykset soitetaan vasta sen jälkeen, kun monia vikoja tapahtuu kyseisen ajanjakson sisällä. Esimerkiksi, jos <B>alertafterille</b> annetaan argumentit &quot;3 30m&quot;, hälytys soitetaan, jos 3 vikaa tapahtuu 30 minuutissa. <P><DT> <B>numalerts</b> <I>numero</i> <DD><P> Tämä muuttuja kehottaa palvelinta soittamaan enintään <I>numerohälytysten</i> kanssa vian aikana. Hälytyslaskuri pidetään ajanjaksona ja se nollataan jokaisen onnistumisen yhteydessä. <P><DT> <B>comp_alerts</b> <DD><P> Jos tämä vaihtoehto määritetään, upalert-soittoja kutsutaan vain, jos vastaava &quot;alas&quot; -hälytys on kutsuttu. <P><DT> <B>hälytyshälytys</b> <I>[arg ...]</i> <DD> Jakso voi sisältää useita hälytyksiä, jotka laukaistaan palvelun epäonnistumisen yhteydessä. Hälytys määritetään <B>varoitusavaimella</b> , jota seuraa valinnainen <B>poistumisparametri</b> , ja argumentit, jotka tulkitaan samalla tavalla kuin <B>monitorin</b> määritelmä, mutta ilman &quot;;;&quot; poikkeus. <B>Poistumisparametri</b> on muodossa <B>exit = x</b> tai <B>exit = xy</b> ja sen seurauksena, että hälytys soitetaan vain, jos monitorikomentosarjan poistotila on <B>exit-</b> parametrin alueella. Jos esimerkiksi hälytys linja on <I>valpas poistu = 10-20 mail.alert mis</i> sitten <I>posti-hälytys</i> vain voida vedota <I>mis</i> argumentit jos näyttö ohjelman irtautumisarvoon on välillä 10 ja 20. Tämän toiminnon avulla voit laukaista erilaiset hälytykset eri vakavuusasteilla (kuten kun vapaan levytilan määrä nousee 8%: sta 3%: iin). <P> Katso <B>ALERT OHJELMAT</b> osio yllä luetteloa pramaeters mon siirtyy automaattisesti hälytyksen ohjelmia. <P><DT> <B>upalert</b> <I>hälytys [arg ...]</i> <DD> <B>Upalert</b> on <B>hälytyksen</b> <B>komplimentti</b> . Upalert kutsutaan, kun palvelut tekevät valtion siirtymisen epäonnistumisesta menestykseen. <B>Upalert-</b> skriptiä kutsutaan samojen parametrien toimittamiseksi kuin <B>hälytyskomentosarja</b> , lisättynä <B>-u-</b> parametrilla, jota käytetään yksinkertaisesti ilmoittamaan hälytyskomentosarjasta, että sitä kutsutaan upalert-tiedoksi. Jokaiselle jaksomääritelmälle voidaan määrittää useita upaleartteja. Huomaa, että oletuskäyttäytyminen on, että upalert lähetetään riippumatta siitä, onko aiempia &quot;alas&quot; -hälytyksiä lähetetty, koska upalerts laukaistaan tilamuutoksessa. Aseta jaksoittainen <B>comp_alerts</b> -vaihtoehto pariksi upalerts-pariksi &quot;alas&quot; -hälytysten kanssa. <P><DT> <B>käynnistyshälytys</b> <I>[arg ...]</i> <DD> <B>Startupalert</b> kutsutaan vain, kun <B>ma</b> palvelin aloittaa suorituksen. <P><DT> <B>upalertaternual-</b> <I>ajan jälkeen</i> <DD> <B>Upalertatern-</b> parametri määritetään merkkijonona, joka seuraa <B>aikaväliparametrin</b> syntaksia (&quot;30s&quot;, &quot;1m&quot; jne.) Ja ohjaa <B>upalertin</b> laukaisua. Jos palvelu palaa takaisin sen jälkeen, kun se on ollut alaspäin yhtä aikaa tai yhtä suuri kuin tämän vaihtoehdon arvo, <B>soitetaan upalert</b> . Käytä tätä vaihtoehtoa estääksesi upalert-nimien kutsumista &quot;hämärtymien&quot; (lyhyiden katkoksien) takia. <P>