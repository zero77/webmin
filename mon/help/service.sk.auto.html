<header> MON Pomoc pri definovaní služieb </header><p> Toto je druhá a posledná etapa konfigurácie MON. <p> Predvolené hodnoty sa zobrazujú pre povinné služby <marked in RED color> , Viac informácií o definíciách služieb nájdete v príslušnej téme pomoci uvedenej nižšie. <p> Pre <b>&quot;mail.alert&quot;</b> sa uistite, že je nakonfigurovaný <b>sendmail</b> a na hostmachine je spustený deamon <b>&quot;sendmail&quot;</b> . <H3> Definície služieb </H3><P><DL COMPACT><DT> <B>service</b> <I>servicename</i> <DD> Definícia služby začína kľúčovým slovom <B>služba</b> nasledovaným slovom, ktoré je značkou pre túto službu. <P> Komponenty služby sú definícia intervalu, monitora a jedného alebo viacerých časových období, ako je definované nižšie. <P> Ak je názov služby „default“ definovaný v skupine sledovateľov nazvanej „dafault“ (pozri vyššie), potom sa použije predvolená / predvolená definícia na spracovanie neznámych mon pascí. <P><DT> <B>interval</b> <I>timeval</i> <DD> <B>Interval</b> kľúčového slova nasledovaný časovou hodnotou určuje frekvenciu spustenia skriptu monitora. Hodnoty času sú definované ako „30 s“, „5 m“, „1 h“ alebo „1d“, čo znamená 30 sekúnd, 5 minút, 1 hodinu alebo 1 deň. Číselná časť môže byť zlomok, napríklad „1,5 hodiny“ alebo hodinu a pol. Tento formát časovej špecifikácie sa bude označovať ako <I>časový údaj</i> . <P><DT> <B>časový</b> <I>harmonogram</i> <DD> Toto kľúčové slovo má rovnaký špecifikácia argumentu úväzok ako <B><I>interval,</i></b> a robí službu očakávajú pasce z externého zdroja aspoň tak často, inak zlyhanie bude registrovaný. Používa sa na službu v štýle srdca. <P><DT> <B>časová</b> <I>náročnosť pasce</i> <DD> Ak je pasca prijatá, stav služby, do ktorej bola pasca doručená, zostane normálne konštantný. Ak je zadaná <B>interpunkcia</b> , stav služby zostane v stave poruchy po dobu stanovenú <I>časovým údajom</i> a potom sa nastaví na „úspech“. <P><DT> <B>randskew</b> <I>timeval</i> <DD> Skôr než naplánovať, aby sa monitorovací skript spúšťal na začiatku každého intervalu, náhodne upravte interval určený parametrom <B>intervalu</b> pomocou plus alebo mínus <B>randskew.</b> Hodnota skosenia je zadaná ako parameter <B>intervalu</b> : „30s“, „5m“ atď. Napríklad, ak je <B>interval</b> 1m a <B>randskew</b> je „5s“, potom <I>mon</i> naplánuje skript monitora niekedy medzi každých 55 sekúnd a 65 sekúnd. Zámerom je pomôcť distribuovať zaťaženie servera, keď je naplánovaných veľa služieb v rovnakých intervaloch. <P><DT> <B>Monitor</b> <I>Monitor-name [arg ...]</i> <DD> <B>Monitor</b> kľúčových slov nasledovaný názvom skriptu a argumentmi určuje monitor, ktorý sa má spustiť po uplynutí časovača. Pri špecifikovaní argumentov, ktoré sa majú odoslať do skriptu monitora, sa dodržiavajú konvencie citovania v štýle shellu. Skript sa vyvolá z adresára s argumentom <B>-s</b> a všetky nasledujúce slová sa dodávajú ako argumenty do monitorovacieho programu, za ktorým nasleduje zoznam hostiteľov v skupine, na ktorú sa vzťahuje aktuálna skupina sledovania. Ak riadok monitora končí znakom „;;“ ako samostatné slovo nie sú skupiny hostiteľov pri vyvolaní programu pripojené k zoznamu argumentov. <P><DT> <B>allow_empty_group</b> <DD> Voľba <B>allow_empty_group</b> umožní <B>spustenie</b> monitora, aj keď je skupina hostiteľov pre tieto hodinky prázdna z dôvodu zakázaných hostiteľov. Predvolené správanie nie je vyvolanie monitora, keď boli deaktivovaní všetci hostitelia v skupine hostiteľov. <P><DT> <B>description</b> <I>descriptiontext</i> <DD> Text Nasledujúci <B>popis</b> je položená klientske programy prešlo k záznamom a monitorov pomocou premennej prostredia. Mal by obsahovať stručný popis služby, vhodný na zahrnutie do e-mailu alebo na webovú stránku. <P><DT> <I>hostiteľ hostiteľa</i> <B>vylúčenia_hostiteľov</b> <I>[hostiteľ ...]</i> <DD> Všetci hostitelia uvedení na <B>zozname_hostiteľov</b> budú vylúčení z kontroly služby. <P><DT> <B>vylúčiť obdobie</b> <I>periódy</i> <DD> Nespúšťajte plánovaný monitor v čase <I>určenom</i> podľa <I>časového úseku</i> . <P><DT> <B>závislý</b> <I>výraz</i> <DD> Kľúčové slovo <B>závislosti</b> sa používa na určenie výrazu závislosti, ktorý sa vyhodnocuje ako pravdivý alebo nepravdivý, v boolovskom slova zmysle. Závislosti sú skutočné výrazy Perlu a musia sa riadiť všetkými syntaktickými pravidlami. Výrazy sa hodnotia vo svojom vlastnom baliacom priestore tak, aby náhodne nemali nejaké nežiaduce vedľajšie účinky. Ak sa pri vyhodnotení výrazu nájde syntaktická chyba, zaznamená sa prostredníctvom syslogu. <P> Pred vyhodnotením sa vo výraze vyskytnú tieto substitúcie: vety, ktoré vyzerajú ako „skupina: služba“, sa nahradia hodnotou aktuálneho prevádzkového stavu danej špecifikovanej služby. Tieto substitúcie opstatus sa počítajú rekurzívne, takže ak služba A závisí od služby B a služba B závisí od služby C, potom služba A závisí od služby C. Úspešné prevádzkové stavy (ktoré sa vyhodnocujú na „1“) sú „STAT_OK“, „STAT_COLDSTART“ &quot;,&quot; STAT_WARMSTART &quot;a&quot; STAT_UNKNOWN &quot;. Slovo „SELF“ (vo všetkých veľkých písmenách) sa môže použiť pre skupinu (napr. „SELF: služba“) a predstavuje skratku pre aktuálnu skupinu sledovaných osôb. <P> Táto vlastnosť sa môže použiť na riadenie výstrah pre služby, ktoré sú závislé od iných služieb, napr. Test SMTP, ktorý závisí od toho, či je stroj ping dosiahnuteľný. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> Vyhodnotenie grafov závislosti môže kontrolovať potlačenie varovania alebo sledovanie vyvolania. <P> <B>Potlačenie výstrahy</b> . Ak je táto voľba nastavená na „a“, bude závislosť vyjadrená po ukončení sledovania služby alebo po prijatí pasce. Výstraha bude odoslaná iba v prípade, že vyhodnotenie bude úspešné, čo znamená, že žiadny z uzlov v grafe závislosti nenaznačuje zlyhanie. <P> <B>Monitorujte potlačenie</b> . Ak je nastavený na &quot;m&quot;, potom bude závislosť vyjadrená pred spustením monitora služby. Ak je evakuácia úspešná, monitor sa spustí. V opačnom prípade sa monitor nespustí a stav služby zostane rovnaký. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Definície období </H3><P> Obdobia sa používajú na definovanie podmienok, ktoré by mali umožniť vydávanie varovaní. <P><DL COMPACT><DT> <B>Doba</b> <I>[štítok:] periodspec</i> <DD> Obdobie zoskupuje jeden alebo viac alarmov a premenných, ktoré určujú, ako často sa výstraha stane, keď dôjde k poruche. Kľúčové slovo <B>obdobia</b> má dve formy. Prvý berie argument, ktorý je špecifikáciou obdobia z modulu Patrick Ryan Time :: Period Perl 5. Viac informácií nájdete v časti „Perldoc Time :: Period“. <P> Druhý formulár vyžaduje označenie, za ktorým nasleduje špecifikácia obdobia, ako je definované vyššie. Štítok je značka pozostávajúca z abecedného znaku alebo znaku podčiarknutia, za ktorým nasleduje nula alebo viac alfanumerických znakov alebo znakov podčiarknutých a končiacich dvojbodkou. Tento formulár umožňuje viac období s rovnakou definíciou obdobia. Jedným použitím je definícia obdobia, ktorá nemá žiadne parametre <B>výstrahy</b> alebo <B>výstrahy</b> pre konkrétne časové obdobie a ďalšie pre rovnaké časové obdobie s inou sadou výstrah, ktoré tieto parametre obsahujú. <P><DT> <B>včasnosť</b> <I>pohotovosti</i> <DD> <B>Kľúčové</b> slovo <B>výstrahy</b> (v rámci definície <B>periódy</b> ) má rovnaký typ argumentu ako <B>intervalová</b> premenná a obmedzuje počet odoslaní výstrahy v prípade zlyhania služby. Napríklad, ak je interval „1 h“, výstrahy v sekcii periódy sa spustia iba raz za hodinu. Ak je kľúčové slovo <B>alertevery</b> v položke obdobia vynechané, upozornenie sa vyšle zakaždým, keď sa zistí zlyhanie. Ak sa výstup dvoch po sebe nasledujúcich porúch zmení, predvolene sa interval alertevery prepíše. Ak je posledným argumentom slovo „zhrnutie“, pri porovnávaní výstupu opakovaných zlyhaní sa budú brať do úvahy iba výstupné riadky. <P><DT> <B>výstraha po</b> <I>č</i> <DD><P><DT> <B>výstraha po</b> <I>num timeval</i> <DD> <B>Kľúčové</b> slovo <B>výstrahy po</b> (v časti <B>obdobia</b> ) má dve formy: iba s argumentom „num“ alebo s argumentmi „num timeval“. V prvej forme sa výstraha spustí až po „počte“ následných zlyhaní. <P> V druhej forme sú argumenty kladné celé číslo, za ktorým nasleduje interval, ako je opísané vyššie v premennej <B>intervalu</b> . Ak sú tieto parametre zadané, výstrahy pre dané obdobie sa budú vyvolávať až potom, keď v tomto intervale dôjde k mnohým chybám. Napríklad, ak je po <B>výstrahe</b> uvedené argumenty „3 30 m“, výstraha sa spustí, ak <B>dôjde k trom</b> zlyhaniam do 30 minút. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Táto premenná hovorí serveru, aby počas zlyhania <I>nevolával</i> viac ako <I>num</i> výstrah. Počítadlo výstrah sa uchováva na základe periódy a po každom úspechu sa vynuluje. <P><DT> <B>comp_alerts</b> <DD><P> Ak je táto voľba zadaná, vyvolá sa upalerts, iba ak bude vyvolaná zodpovedajúca výstraha „down“. <P><DT> <B>výstražné</b> <I>upozornenie [arg ...]</i> <DD> Obdobie môže obsahovať viacnásobné varovania, ktoré sa spustia pri zlyhaní služby. Výstraha je špecifikovaná pomocou kľúčového slova <B>výstrahy</b> , za ktorým nasleduje voliteľný <B>výstupný</b> parmeter a argumenty, ktoré sú interpretované rovnako ako definícia <B>monitora</b> , ale bez znaku &quot;;;&quot; výnimka. <B>Výstupný</b> parameter má formu <B>exit = x</b> alebo <B>exit = xy</b> a má za následok, že sa výstraha volá iba vtedy, ak výstupný stav monitorovacieho skriptu spadá do rozsahu <B>výstupného</b> parametra. Ak sa napríklad, výstraha linka je <I>v strehu exit = 10-20 mail.alert mis</i> potom <I>mailovej výstrahy</i> bude vyvolaná iba s <I>mis</i> ako jeho argumenty, ak výstupná hodnota na monitore programu je medzi 10 a 20. Táto funkcia umožňuje spúšti rôzne upozornenia na rôznych úrovniach závažnosti (napríklad keď voľné miesto na disku klesne z 8% na 3%). <P> V časti <B>VÝSTRAŽNÉ PROGRAMY</b> vyššie nájdete zoznam indikátorov, ktoré automaticky prejdú na výstražné programy. <P><DT> <B>upalert</b> <I>alert [arg ...]</i> <DD> <B>Čalúnenie</b> je doplnkom <B>varovania</b> . Zvýšenie sa nazýva, keď služby prechádzajú zo zlyhania na úspech. <B>Vylepšený</b> skript sa nazýva dodávajúci rovnaké parametre ako <B>výstražný</b> skript, s pridaním parametra <B>-u,</b> ktorý sa jednoducho používa na informovanie výstražného skriptu, že sa volá ako upalert. Pre každú definíciu obdobia možno uviesť viac upozícií. Upozorňujeme, že predvoleným správaním je, že upalert bude odoslaný bez ohľadu na to, či už boli zaslané nejaké predchádzajúce „down“ výstrahy, pretože upalert sa spustí pri prechode stavu. Nastavte možnosť <B>comp_alerts</b> za obdobie <B>tak,</b> aby spárovala upalerts s upozorneniami „down“. <P><DT> <I>upozornenie pri</i> <B>spustení</b> <I>[arg ...]</i> <DD> <B>Startalert</b> sa volá iba vtedy, keď <B>mon</b> server začne vykonávať. <P><DT> <B>hore nad</b> <I>časom</i> <DD> Parameter <B>upalertafter</b> je špecifikovaný ako reťazec, ktorý sleduje syntax <B>intervalového</b> parametra (&quot;30s&quot;, &quot;1m&quot; atď.) A riadi spúšťanie <B>upalert</b> . Ak sa služba vráti po <B>výpadku</b> po dobu dlhšiu alebo rovnajúcu sa hodnote tejto možnosti, bude <B>vyvolaný upalert</b> . Táto voľba slúži na zabránenie tomu, aby sa volali na upgrady kvôli „bliknutiu“ (krátke výpadky). <P>