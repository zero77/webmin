<header> Помощ на MON относно дефинициите на услугата </header><p> Това е втори и последен етап за конфигуриране на MON. <p> Стойностите по подразбиране са показани за Задължителните услуги <marked in RED color> , Вижте съответната тема за помощ по-долу за повече помощ относно дефинициите на услугата. <p> За <b>„mail.alert“ се</b> уверете, че sendmail е конфигуриран и deamon <b>„sendmail“</b> е стартиран на хостмашина. <H3> Дефиниции на услугата </H3><P><DL COMPACT><DT> <B>обслужване</b> <I>SERVICENAME</i> <DD> Дефиницията на услугата започва с <B>услугата за</b> ключови думи <B>,</b> последвана от дума, която е тагът за тази услуга. <P> Компонентите на услугата са интервал, монитор и едно или повече дефиниции на времеви период, както са дефинирани по-долу. <P> Ако името на услугата от &quot;default&quot; е дефинирано в група за наблюдение, наречена &quot;dafault&quot; (вижте по-горе), тогава дефиницията по подразбиране / по подразбиране ще се използва за обработка на неизвестни мон капани. <P><DT> <B>интервал</b> <I>времева</i> <B>интервал</b> <DD> <B>Интервалът на</b> ключовите думи <B>,</b> последван от времева стойност, определя честотата, на която ще бъде задействан скриптът на монитора. Времевите стойности са дефинирани като &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot; или &quot;1d&quot;, което означава 30 секунди, 5 минути, 1 час или 1 ден. Числовата част може да бъде фракция, например &quot;1,5h&quot; или час и половина. Този формат на спецификация време ще бъде по-нататък <I>timeval.</i> <P><DT> <B>traptimeout</b> <I>timeval</i> <DD> Тази ключова дума е на същия аргумент време спецификация като <B><I>интервал,</i></b> и прави услугата очакваме капан от външен източник най-малко, че често, друг провал ще бъде регистрирано. Това се използва за услуга в сърцето. <P><DT> <B>trapduration</b> <I>timeval</i> <DD> Ако се получи капан, състоянието на услугата, в която е доставен капана, обикновено остава постоянна. Ако се <B>зададе трапдурацията</b> , състоянието на услугата ще остане в състояние на отказ за продължителността, определена от <I>timeval</i> , и след това ще бъде върната до &quot;успех&quot;. <P><DT> <B>randskew</b> <I>timeval</i> <DD> Вместо да планирате скрипта на монитора да се изпълнява в началото на всеки интервал, произволно коригирайте интервала, определен от параметъра на <B>интервала</b> , чрез плюс-или-минус <B>randskew.</b> Стойността на наклона е посочена като параметър на <B>интервала</b> : &quot;30s&quot;, &quot;5m&quot; и т.н. ... Например, ако <B>интервалът</b> е 1m, а <B>randskew</b> е &quot;5s&quot;, <I>mon</i> ще планира скрипта на монитора известно време между всеки 55 секунди и 65 секунди Намерението е да се помогне да се разпредели натоварването на сървъра, когато много услуги са планирани на еднакви интервали. <P><DT> <B>монитор</b> <I>-име на монитор [арг ...]</i> <DD> <B>Мониторът на</b> ключовите думи, последван от име на скрипт и аргументи, указва на монитора да се стартира, когато таймерът изтече. Конвенциите за цитиране, подобни на черупки, се спазват при уточняване на аргументите, които да бъдат изпратени към скрипта на монитора. Скриптът се извиква от директорията, дадена с аргумента <B>-s</b> , и всички следващи думи се предоставят като аргументи на мониторната програма, последвана от списъка на хостове в групата, посочена от текущата група за наблюдение. Ако линията на монитора завършва с &quot;;&quot; като отделна дума, хост групите не се добавят към списъка с аргументи при извикване на програмата. <P><DT> <B>allow_empty_group</b> <DD> Опцията <B>allow_empty_group</b> ще позволи на един монитор да бъде приведена в действие дори когато hostgroup за този часовник е празен, защото на Силите с увреждания. Поведението по подразбиране не е да извиквате монитора, когато всички хостове в хост група са деактивирани. <P><DT> <B>описание</b> <I>описание</i> <DD> Следващото <B>описание на</b> текста се запитва от клиентски програми, предава се на сигнали и монитори чрез променлива среда. Той трябва да съдържа кратко описание на услугата, подходящо за включване в имейл или на уеб страница. <P><DT> <B>изключете_хости</b> <I>хост [хост ...]</i> <DD> Всички хостове, изброени след <B>exce_hosts,</b> ще бъдат изключени от проверката на услугата. <P><DT> <B>exclude_period</b> <I>periodspec</i> <DD> Не пускайте планиран монитор по време, определено от <I>periodpec</i> . <P><DT> <B>зависи</b> <I>dependexpression</i> <DD> Ключовата дума за <B>зависимост</b> се използва за определяне на израз на зависимост, който се изчислява на или вярно на невярно, в булев смисъл. Зависимостите са действителни Perl изрази и трябва да се подчиняват на всички синтактични правила. Изразът се оценява в тяхното собствено пространство за пакети, за да не случайно да има някакъв нежелан страничен ефект. Ако при оценка на израза се намери синтаксична грешка, тя се регистрира чрез syslog. <P> Преди оценка се появяват следните замествания на израза: фрази, които приличат на &quot;група: услуга&quot;, се заменят със стойността на текущото оперативно състояние на посочената услуга. Тези замествания на opstatus се изчисляват рекурсивно, така че ако услугата A зависи от услуга B и услуга B зависи от услуга C, тогава услугата A зависи от услуга C. Успешните оперативни състояния (които се оценяват на &quot;1&quot;) са &quot;STAT_OK&quot;, &quot;STAT_COLDSTART &quot;,&quot; STAT_WARMSTART &quot;и&quot; STAT_UNKNOWN &quot;. Думата „SELF“ (във всички главни букви) може да се използва за групата (напр. „SELF: service“) и е съкращение за текущата група за гледане. <P> Тази функция може да се използва за контрол на сигнали за услуги, които са зависими от други услуги, напр. SMTP тест, който зависи от машината, която е пинг-достъпна. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> Оценката на графовете за зависимост може да контролира потискането или на алармени, или на мониторни извиквания. <P> <B>Потискане на сигнала</b> Ако тази опция е зададена на &quot;a&quot;, изразът на зависимост ще бъде оценен след като мониторът за услугата излезе или след получаване на капан. Предупреждение ще бъде изпратено само ако оценката е успешна, което означава, че никой от възлите в графа на зависимостта не показва грешка. <P> <B>Наблюдавайте потискането</b> . Ако е зададено на &quot;m&quot;, изразът на зависимост ще бъде евалуиран, преди мониторът за услугата да се стартира. Ако евалацията успее, мониторът ще се стартира. В противен случай мониторът няма да се стартира и състоянието на услугата ще остане същото. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Определения за периода </H3><P> Периодите се използват за определяне на условията, които трябва да позволяват подаване на сигнали. <P><DL COMPACT><DT> <B>период</b> <I>[етикет:] периоди</i> <DD> Периодът групира един или повече аларми и променливи, които контролират колко често се получава предупреждение, когато има повреда. Ключовата дума за <B>периода</b> има две форми. Първият взема аргумент, който е спецификация на период от модула Патрик Райън Време :: Период Perl 5. Вижте &quot;Perldoc Time :: Period&quot; за повече информация. <P> Вторият формуляр изисква етикет, последван от спецификация на периода, както е определено по-горе. Етикетът е етикет, състоящ се от азбучен символ или подчертаване, последван от нула или повече буквено-цифрови знаци или подчертаване и завършващ с двоеточие. Тази форма позволява множество периоди с едно и също определение на периода. Една употреба е да има определение на период, който няма параметри за <B>предупреждение</b> или <B>предупреждение</b> за определен период от време, а друго за същия период с различен набор от сигнали, който съдържа тези параметри. <P><DT> <B>alertevery</b> <I>timeval</i> <DD> <B>Ключовата</b> дума за <B>предупреждение</b> (в дефиниция на <B>период</b> ) приема същия тип аргумент като променливата на <B>интервала</b> и ограничава броя на изпращанията на сигнал, когато услугата продължава да се отказва. Например, ако интервалът е &quot;1h&quot;, тогава само сигналите в секцията период ще се задействат само веднъж на час. Ако ключовата дума за <B>предупреждение</b> е пропусната при запис на период, ще се изпраща предупреждение всеки път, когато се установи грешка. По подразбиране, ако изходът от две последователни грешки се промени, тогава интервалът на сигнализация се отменя. Ако думата &quot;резюме&quot; е последният аргумент, тогава при сравняване на изхода на последователни откази ще се вземат предвид само резюмените изходни редове. <P><DT> <B>предупредително</b> <I>число</i> <DD><P><DT> <B>timevaval</b> <I>num</i> <B>timevalval</b> <DD> <B>Ключовата</b> дума за <B>предупреждение</b> (в раздел за <B>период</b> ) има две форми: само с аргумента &quot;num&quot; или с аргументите &quot;num timeval&quot;. В първия формуляр ще бъде извикан предупреждение само след последователни грешки &quot;num&quot;. <P> Във втората форма аргументите са положително цяло число, последвано от интервал, както е описано от променливата на <B>интервала</b> по-горе. Ако тези параметри са посочени, алармите за този период ще бъдат извиквани едва след като в този интервал се появят много повреди. Например, ако на <B>предупредителя</b> е даден аргументът &quot;3 30m&quot;, тогава предупреждението ще бъде извикано, ако в рамките на 30 минути се случат 3 отказа. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Тази променлива казва на сървъра да извика не повече от <I>num</i> сигнали по време на повреда. Броячът на предупреждения се поддържа периодично и се нулира при всеки успех. <P><DT> <B>comp_alerts</b> <DD><P> Ако тази опция е посочена, upalerts ще бъде извикан само ако е бил извикан съответния сигнал за „надолу“. <P><DT> <B>сигнал за</b> <I>предупреждение [арг ...]</i> <DD> Периодът може да съдържа множество сигнали, които се задействат при отказ на услугата. Предупреждението се определя с ключовата дума за <B>предупреждение</b> , последвано от незадължителен <B>изходен</b> парметър и аргументи, които се интерпретират същото като дефиницията на <B>монитора</b> , но без &quot;;&quot; изключение. Параметърът на <B>изход</b> има формата на <B>изход = x</b> или <B>изход = xy</b> и има ефект, че предупреждението се извиква само ако състоянието на изход на скрипта на монитора попада в обхвата на параметъра на <B>изхода</b> . Ако, например, редът на предупреждение е <I>изход на предупреждение = 10-20 mail.alert mis,</i> тогава <I>пощата-предупреждение</i> ще бъде извикана с <I>mis</i> като негови аргументи, само ако стойността на изхода на мониторната програма е между 10 и 20. Тази функция ви позволява да задействате различни сигнали при различни нива на тежест (например, когато свободното пространство на диска отива от 8% до 3%). <P> Вижте секцията <B>ALERT</b> PROGRAMS по-горе за списък на праматерите, които автоматично ще преминат към програми за предупреждение. <P><DT> <I>предупреждение за</i> <B>upalert</b> <I>[арг ...]</i> <DD> <B>Upalert</b> е комплиментът на <B>сигнала</b> . Upalert се извиква, когато дадена услуга прави държавата преход от неуспех към успех. Скриптът на <B>upalert</b> се нарича доставяне на същите параметри като скрипта за <B>предупреждение</b> , с добавяне на параметъра <B>-u</b> , който просто се използва, за да уведоми скрипт за предупреждение, че се извиква като upalert. За всяка дефиниция на периода могат да бъдат посочени множество пакети. Моля, обърнете внимание, че поведението по подразбиране е, че ще бъде изпратен upalert независимо дали са изпратени предишни предупреждения за „надолу“, тъй като upalerts се задействат при преход на състояние. Задайте опцията <B>comp_alerts за</b> период, за да сдвоите upalerts с „надолу“ сигнали. <P><DT> <I>предупреждение за</i> <B>стартиране</b> <I>[арг ...]</i> <DD> <B>Startupalert</b> се извиква само когато <B>mon</b> сървърът започне изпълнението. <P><DT> <B>upalertafter</b> <I>timeval</i> <DD> Параметърът <B>upalertafter</b> се определя като низ, който следва синтаксиса на параметъра <B>интервал</b> (&quot;30s&quot;, &quot;1m&quot; и т.н.) и контролира задействането на <B>upalert</b> . Ако дадена услуга се възстанови след като бъде прекъсната за време, по-голямо или равно на стойността на тази опция, ще се извика <B>upalert</b> . Използвайте тази опция, за да предотвратите извикването на upalerts поради „прекъсвания“ (кратки прекъсвания). <P>