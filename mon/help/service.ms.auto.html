<header> Bantuan MON mengenai Definisi Perkhidmatan </header><p> Ini adalah peringkat kedua dan terakhir untuk konfigurasi MON. <p> Nilai lalai ditunjukkan untuk perkhidmatan Wajib <marked in RED color> . Lihat topik bantuan masing-masing di bawah untuk mendapatkan bantuan lebih lanjut mengenai Definisi Perkhidmatan. <p> Untuk <b>&quot;mail.alert&quot;</b> , pastikan bahawa sendmail dikonfigurasi dan deamon <b>&quot;sendmail&quot;</b> dimulakan di hostmachine. <H3> Definisi Perkhidmatan </H3><P><DL COMPACT><DT> <B>perkhidmatan</b> <I>SERVICENAME</i> <DD> Definisi perkhidmatan bermula dengan kata kunci <B>perkhidmatan</b> diikuti dengan kata yang merupakan tanda untuk perkhidmatan ini. <P> Komponen perkhidmatan adalah selang, monitor, dan satu atau lebih definisi jangka masa, seperti yang ditentukan di bawah. <P> Sekiranya nama perkhidmatan &quot;lalai&quot; ditentukan dalam kumpulan menonton yang disebut &quot;dafault&quot; (lihat di atas), maka definisi lalai / lalai akan digunakan untuk menangani perangkap mon yang tidak diketahui. <P><DT> <B>selang</b> <I>timeval</i> <DD> <B>Selang</b> kata kunci diikuti oleh nilai waktu menentukan kekerapan skrip monitor akan dicetuskan. Nilai masa ditakrifkan sebagai &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot;, atau &quot;1d&quot;, yang bermaksud 30 saat, 5 minit, 1 jam, atau 1 hari. Bahagian berangka mungkin pecahan, seperti &quot;1.5h&quot; atau satu setengah jam. Format spesifikasi masa ini akan disebut sebagai <I>jangka waktu</i> . <P><DT> <B>jangka masa</b> <I>traptimeout</i> <DD> Kata kunci ini mengambil argumen spesifikasi masa yang sama dengan <B>selang waktu</b> <I>,</i> dan menjadikan perkhidmatan mengharapkan perangkap dari sumber luaran sekurang-kurangnya selalunya, jika tidak, kegagalan akan didaftarkan. Ini digunakan untuk perkhidmatan gaya degupan jantung. <P><DT> <B>jangka masa</b> <I>perangkap</i> <DD> Sekiranya perangkap diterima, status perkhidmatan perangkap yang dihantar biasanya akan tetap. Sekiranya <B>trapduration</b> ditentukan, status perkhidmatan akan tetap berada dalam keadaan kegagalan selama tempoh yang ditentukan oleh <I>selang waktu</i> , dan kemudian akan diset semula ke &quot;berjaya&quot;. <P><DT> <B>jangka masa</b> <I>randskew</i> <DD> Daripada menjadualkan skrip monitor untuk dijalankan pada permulaan setiap selang, sesuaikan secara rawak selang yang ditentukan oleh parameter <B>selang</b> dengan tambah-atau-minus <B>randskew.</b> Nilai skew ditentukan sebagai parameter <B>selang</b> : &quot;30s&quot;, &quot;5m&quot;, dll ... Contohnya jika <B>selang</b> 1m, dan <B>randskew</b> adalah &quot;5s&quot;, maka <I>mon</i> akan menjadualkan skrip monitor beberapa waktu antara setiap 55 saat dan 65 saat. Tujuannya adalah untuk membantu menyebarkan beban pada pelayan apabila banyak perkhidmatan dijadualkan pada selang waktu yang sama. <P><DT> <B>monitor</b> <I>-nama monitor [arg ...]</i> <DD> <B>Monitor</b> kata kunci diikuti dengan nama skrip dan argumen menentukan monitor untuk dijalankan apabila pemasa tamat. Konvensyen sebut harga Shell diikuti ketika menentukan argumen untuk dikirim ke skrip monitor. Skrip dipanggil dari direktori yang diberikan dengan argumen <B>-s</b> , dan semua kata-kata berikut diberikan sebagai argumen untuk program monitor, diikuti oleh daftar host dalam kumpulan yang disebut oleh kumpulan menonton semasa. Sekiranya garis monitor diakhiri dengan &quot;;;&quot; sebagai kata yang terpisah, kumpulan tuan rumah tidak ditambahkan ke senarai argumen ketika program dipanggil. <P><DT> <B>izinkan_kumpulan_kumpulan</b> <DD> Pilihan <B>allow_empty_group</b> akan membolehkan monitor dipanggil walaupun kumpulan host untuk jam tangan itu kosong kerana host yang dilumpuhkan. Tingkah laku lalai adalah tidak memanggil monitor apabila semua host dalam kumpulan host telah dilumpuhkan. <P><DT> <B>huraian</b> <I>deskripsi teks</i> <DD> Teks <B>keterangan</b> berikut ditanyakan oleh program pelanggan, diserahkan kepada amaran dan monitor melalui pemboleh ubah persekitaran. Ini harus mengandungi penerangan ringkas mengenai perkhidmatan, sesuai untuk dimasukkan ke dalam e-mel atau di laman web. <P><DT> <B>exclude_hosts</b> <I>host [hos ...]</i> <DD> Mana-mana hos yang disenaraikan selepas <B>exclude_host</b> akan dikecualikan dari pemeriksaan perkhidmatan. <P><DT> <B>exclude_period</b> <I>periodpec</i> <DD> Jangan jalankan monitor berjadual pada masa yang dikenalpasti oleh <I>periodpec</i> . <P><DT> <B>bergantung kepada</b> <I>ekspresi</i> <DD> Kata kunci <B>bergantung</b> digunakan untuk menentukan ungkapan ketergantungan, yang menilai sama ada benarnya salah, dalam pengertian boolean. Ketergantungan adalah ungkapan Perl yang sebenarnya, dan mesti mematuhi semua peraturan sintaksis. Ungkapan-ungkapan tersebut dinilai di ruang pakej mereka sendiri agar tidak menimbulkan kesan sampingan yang tidak diingini. Sekiranya terdapat ralat sintaks semasa menilai ungkapan, ia akan dicatat melalui syslog. <P> Sebelum penilaian, penggantian ungkapan berikut berlaku: frasa yang kelihatan seperti &quot;kumpulan: perkhidmatan&quot; diganti dengan nilai status operasi semasa perkhidmatan yang ditentukan itu. Penggantian opstatus ini dikira secara berulang, jadi jika perkhidmatan A bergantung pada perkhidmatan B, dan perkhidmatan B bergantung pada perkhidmatan C, maka perkhidmatan A bergantung pada perkhidmatan C. Status operasi yang berjaya (yang dinilai menjadi &quot;1&quot;) adalah &quot;STAT_OK&quot;, &quot;STAT_COLDSTART &quot;,&quot; STAT_WARMSTART &quot;, dan&quot; STAT_UNKNOWN &quot;. Kata &quot;SELF&quot; (dalam semua huruf besar) dapat digunakan untuk kumpulan (misalnya &quot;SELF: service&quot;), dan merupakan singkatan untuk kumpulan menonton sekarang. <P> Ciri ini dapat digunakan untuk mengendalikan peringatan untuk perkhidmatan yang bergantung pada perkhidmatan lain, misalnya ujian SMTP yang bergantung pada mesin yang dapat dicapai dengan ping. <P><DT> <B>dep_behavior</b> <I>{a | m}</i> <DD> Penilaian grafik ketergantungan dapat mengawal penekanan sama ada amaran atau pemantauan pemanggilan. <P> <B>Penindasan amaran</b> . Sekiranya pilihan ini ditetapkan ke &quot;a&quot;, maka ekspresi kebergantungan akan dinilai setelah monitor untuk perkhidmatan keluar atau setelah perangkap diterima. Makluman hanya akan dihantar jika penilaian berjaya, yang bermaksud bahawa tidak ada nod dalam grafik ketergantungan menunjukkan kegagalan. <P> <B>Pantau penindasan</b> . Jika diatur ke &quot;m&quot;, maka ekspresi kebergantungan akan dievaluasi sebelum monitor untuk perkhidmatan akan berjalan. Sekiranya evolusi berjaya, maka monitor akan dijalankan. Jika tidak, monitor tidak akan dijalankan dan status perkhidmatan akan tetap sama. <P></DL><A NAME="lbAO">&nbsp;</A><H3> Definisi Tempoh </H3><P> Jangkamasa digunakan untuk menentukan keadaan yang seharusnya membolehkan peringatan dihantar. <P><DL COMPACT><DT> <B>noktah</b> <I>[label:] periodpec</i> <DD> Tempoh mengelompokkan satu atau lebih penggera dan pemboleh ubah yang mengawal seberapa kerap amaran berlaku apabila terdapat kegagalan. Kata kunci <B>tempoh</b> mempunyai dua bentuk. Yang pertama mengambil argumen yang merupakan spesifikasi tempoh dari modul Patrick Ryan&#39;s Time :: Period Perl 5. Rujuk &quot;Perldoc Time :: Period&quot; untuk maklumat lebih lanjut. <P> Bentuk kedua memerlukan label diikuti dengan spesifikasi periode, seperti yang ditentukan di atas. Label adalah teg yang terdiri daripada aksara abjad atau garis bawah diikuti oleh sifar atau lebih alfanumerik atau garis bawah dan diakhiri dengan titik dua. Bentuk ini membenarkan beberapa tempoh dengan definisi tempoh yang sama. Salah satu penggunaannya adalah untuk memiliki definisi periode yang tidak memiliki <B>peringatan setelah</b> atau <B>peringatan setiap</b> parameter untuk jangka waktu tertentu, dan yang lain untuk jangka waktu yang sama dengan sekumpulan amaran yang berbeda yang mengandung parameter tersebut. <P><DT> <B>berjaga-</b> <I>jaga</i> <B>setiap</b> <I>waktu</i> <DD> <B>Peringatan setiap</b> kata kunci (dalam definisi <B>jangka waktu</b> ) mengambil jenis argumen yang sama dengan pemboleh ubah <B>selang</b> , dan membatasi berapa kali amaran dihantar ketika perkhidmatan terus gagal. Sebagai contoh, jika selang &quot;1h&quot;, maka hanya amaran di bahagian noktah yang akan dipicu sekali setiap jam. Sekiranya <B>peringatan setiap</b> kata kunci dihilangkan dalam entri periode, amaran akan dihantar setiap kali kegagalan dikesan. Secara lalai, jika output dari dua kegagalan berturut-turut berubah, maka selang setiap peringatan akan diganti. Sekiranya perkataan &quot;ringkasan&quot; adalah argumen terakhir, maka hanya garis output ringkasan yang akan dipertimbangkan ketika membandingkan output kegagalan berturut-turut. <P><DT> <B>alertafter</b> <I>num</i> <DD><P><DT> <B>waspada selepas</b> <I>bilangan masa</i> <DD> <B>Kata</b> kunci <B>alert after</b> (dalam bahagian <B>jangka waktu</b> ) mempunyai dua bentuk: hanya dengan argumen &quot;num&quot;, atau dengan argumen &quot;num timeval&quot;. Dalam bentuk pertama, amaran hanya akan dipanggil setelah &quot;num&quot; kegagalan berturut-turut. <P> Dalam bentuk kedua, argumen adalah bilangan bulat positif diikuti oleh selang, seperti yang dijelaskan oleh pemboleh ubah <B>selang di</b> atas. Sekiranya parameter ini ditentukan, maka amaran untuk tempoh tersebut hanya akan dipanggil setelah banyak kegagalan berlaku dalam selang waktu itu. Sebagai contoh, sekiranya <B>alert selepas</b> diberi argumen &quot;3 30m&quot;, maka alert akan dipanggil jika 3 kegagalan berlaku dalam 30 minit. <P><DT> <B>numalerts</b> <I>num</i> <DD><P> Pembolehubah ini memberitahu pelayan untuk memanggil tidak lebih daripada isyarat <I>num</i> semasa kegagalan. Kaunter amaran disimpan setiap tempoh, dan diset semula pada setiap kejayaan. <P><DT> <B>comp_alerts</b> <DD><P> Sekiranya pilihan ini ditentukan, maka pemberitahuan atas hanya akan dipanggil jika amaran &quot;turun&quot; yang sesuai telah dipanggil. <P><DT> <B>amaran</b> <I>amaran [arg ...]</i> <DD> Tempoh mungkin mengandungi banyak amaran, yang dipicu apabila kegagalan perkhidmatan. Makluman ditentukan dengan kata kunci <B>amaran</b> , diikuti dengan parmeter <B>keluar</b> pilihan, dan argumen yang ditafsirkan sama dengan definisi <B>monitor</b> , tetapi tanpa &quot;;;&quot; pengecualian. Parameter <B>keluar</b> mengambil bentuk <B>exit = x</b> atau <B>exit = xy</b> dan memberi kesan bahawa amaran hanya disebut jika status keluar dari skrip monitor berada dalam julat parameter <B>keluar</b> . Jika, sebagai contoh, garis amaran adalah <I>alert alert = 10-20 mail.alert mis</i> maka <I>surat-alert</i> hanya akan dipanggil dengan <I>mis</i> sebagai argumennya jika nilai keluar program monitor antara 10 dan 20. Fitur ini membolehkan anda mencetuskan amaran berbeza pada tahap keparahan yang berbeza (seperti ketika ruang cakera bebas meningkat dari 8% hingga 3%). <P> Lihat bahagian <B>PROGRAM ALERT</b> di atas untuk senarai prameter yang akan dilampirkan secara automatik kepada program amaran. <P><DT> <I>amaran</i> <B>upalert</b> <I>[arg ...]</i> <DD> <B>Pemberitahuan atas</b> adalah pujian <B>amaran</b> . Tertinggi dipanggil apabila perkhidmatan membuat peralihan keadaan dari kegagalan ke kejayaan. Skrip <B>upalert</b> disebut menyediakan parameter yang sama dengan skrip <B>amaran</b> , dengan penambahan parameter <B>-u</b> yang hanya digunakan untuk membiarkan skrip peringatan mengetahui bahawa itu disebut sebagai upalert. Pelbagai peningkatan boleh ditentukan untuk setiap takrif tempoh. Harap maklum bahawa tingkah laku lalai adalah bahawa pemberitahuan atas akan dihantar tanpa mengira ada peringatan &quot;turun&quot; sebelumnya yang dikirimkan, kerana pemberitahuan meningkat dipicu pada peralihan keadaan. Tetapkan pilihan <B>comp_alerts</b> per-period untuk memasangkan lansiran dengan amaran &quot;bawah&quot;. <P><DT> <I>amaran amaran</i> <B>permulaan</b> <I>[arg ...]</i> <DD> <B>Permulaan permulaan</b> hanya dipanggil apabila pelayan <B>mon</b> memulakan pelaksanaan. <P><DT> <B>jangka</b> <I>masa</i> <B>selepas</b> <I>akhir</i> <DD> Parameter <B>upalertafter</b> ditentukan sebagai rentetan yang mengikuti sintaks parameter <B>selang</b> (&quot;30s&quot;, &quot;1m&quot;, dan lain-lain), dan mengawal pemicu <B>upalert</b> . Sekiranya perkhidmatan muncul semula setelah <B>dimatikan</b> untuk waktu yang lebih besar daripada atau sama dengan nilai pilihan ini, <B>pemberitahuan</b> akan dipanggil. Gunakan pilihan ini untuk mengelakkan pemberitahuan atas dipanggil kerana &quot;blips&quot; (pemadaman ringkas). <P>